"use strict";exports.id=430,exports.ids=[430],exports.modules={6047:(e,t,r)=>{e=r.nmd(e);let wrapAnsi256=(e=0)=>t=>`\u001B[${38+e};5;${t}m`,wrapAnsi16m=(e=0)=>(t,r,n)=>`\u001B[${38+e};2;${t};${r};${n}m`;Object.defineProperty(e,"exports",{enumerable:!0,get:function(){let e=new Map,t={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};for(let[r,n]of(t.color.gray=t.color.blackBright,t.bgColor.bgGray=t.bgColor.bgBlackBright,t.color.grey=t.color.blackBright,t.bgColor.bgGrey=t.bgColor.bgBlackBright,Object.entries(t))){for(let[r,a]of Object.entries(n))t[r]={open:`\u001B[${a[0]}m`,close:`\u001B[${a[1]}m`},n[r]=t[r],e.set(a[0],a[1]);Object.defineProperty(t,r,{value:n,enumerable:!1})}return Object.defineProperty(t,"codes",{value:e,enumerable:!1}),t.color.close="\x1b[39m",t.bgColor.close="\x1b[49m",t.color.ansi256=wrapAnsi256(),t.color.ansi16m=wrapAnsi16m(),t.bgColor.ansi256=wrapAnsi256(10),t.bgColor.ansi16m=wrapAnsi16m(10),Object.defineProperties(t,{rgbToAnsi256:{value:(e,t,r)=>e===t&&t===r?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(r/255*5),enumerable:!1},hexToRgb:{value:e=>{let t=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(e.toString(16));if(!t)return[0,0,0];let{colorString:r}=t.groups;3===r.length&&(r=r.split("").map(e=>e+e).join(""));let n=Number.parseInt(r,16);return[n>>16&255,n>>8&255,255&n]},enumerable:!1},hexToAnsi256:{value:e=>t.rgbToAnsi256(...t.hexToRgb(e)),enumerable:!1}}),t}})},8955:(e,t,r)=>{let n;function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var a=_interopDefault(r(2781)),o=_interopDefault(r(3685)),i=_interopDefault(r(7310)),s=_interopDefault(r(3143)),l=_interopDefault(r(5687)),u=_interopDefault(r(9796));let c=a.Readable,d=Symbol("buffer"),h=Symbol("type");let Blob=class Blob{constructor(){this[h]="";let e=arguments[0],t=arguments[1],r=[];if(e){let t=Number(e.length);for(let n=0;n<t;n++){let t;let a=e[n];(t=a instanceof Buffer?a:ArrayBuffer.isView(a)?Buffer.from(a.buffer,a.byteOffset,a.byteLength):a instanceof ArrayBuffer?Buffer.from(a):a instanceof Blob?a[d]:Buffer.from("string"==typeof a?a:String(a))).length,r.push(t)}}this[d]=Buffer.concat(r);let n=t&&void 0!==t.type&&String(t.type).toLowerCase();n&&!/[^\u0020-\u007E]/.test(n)&&(this[h]=n)}get size(){return this[d].length}get type(){return this[h]}text(){return Promise.resolve(this[d].toString())}arrayBuffer(){let e=this[d],t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return Promise.resolve(t)}stream(){let e=new c;return e._read=function(){},e.push(this[d]),e.push(null),e}toString(){return"[object Blob]"}slice(){let e,t;let r=this.size,n=arguments[0],a=arguments[1];e=void 0===n?0:n<0?Math.max(r+n,0):Math.min(n,r),t=void 0===a?r:a<0?Math.max(r+a,0):Math.min(a,r);let o=Math.max(t-e,0),i=this[d],s=i.slice(e,e+o),l=new Blob([],{type:arguments[2]});return l[d]=s,l}};function FetchError(e,t,r){Error.call(this,e),this.message=e,this.type=t,r&&(this.code=this.errno=r.code),Error.captureStackTrace(this,this.constructor)}Object.defineProperties(Blob.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(Blob.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0}),FetchError.prototype=Object.create(Error.prototype),FetchError.prototype.constructor=FetchError,FetchError.prototype.name="FetchError";try{n=Object(function(){var e=Error("Cannot find module 'encoding'");throw e.code="MODULE_NOT_FOUND",e}())}catch(e){}let f=Symbol("Body internals"),p=a.PassThrough;function Body(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.size,o=r.timeout;null==e?e=null:isURLSearchParams(e)?e=Buffer.from(e.toString()):isBlob(e)||Buffer.isBuffer(e)||("[object ArrayBuffer]"===Object.prototype.toString.call(e)?e=Buffer.from(e):ArrayBuffer.isView(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof a||(e=Buffer.from(String(e)))),this[f]={body:e,disturbed:!1,error:null},this.size=void 0===n?0:n,this.timeout=void 0===o?0:o,e instanceof a&&e.on("error",function(e){let r="AbortError"===e.name?e:new FetchError(`Invalid response body while trying to fetch ${t.url}: ${e.message}`,"system",e);t[f].error=r})}function consumeBody(){var e=this;if(this[f].disturbed)return Body.Promise.reject(TypeError(`body used already for: ${this.url}`));if(this[f].disturbed=!0,this[f].error)return Body.Promise.reject(this[f].error);let t=this.body;if(null===t)return Body.Promise.resolve(Buffer.alloc(0));if(isBlob(t)&&(t=t.stream()),Buffer.isBuffer(t))return Body.Promise.resolve(t);if(!(t instanceof a))return Body.Promise.resolve(Buffer.alloc(0));let r=[],n=0,o=!1;return new Body.Promise(function(a,i){let s;e.timeout&&(s=setTimeout(function(){o=!0,i(new FetchError(`Response timeout while trying to fetch ${e.url} (over ${e.timeout}ms)`,"body-timeout"))},e.timeout)),t.on("error",function(t){"AbortError"===t.name?(o=!0,i(t)):i(new FetchError(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,"system",t))}),t.on("data",function(t){if(!o&&null!==t){if(e.size&&n+t.length>e.size){o=!0,i(new FetchError(`content size at ${e.url} over limit: ${e.size}`,"max-size"));return}n+=t.length,r.push(t)}}),t.on("end",function(){if(!o){clearTimeout(s);try{a(Buffer.concat(r,n))}catch(t){i(new FetchError(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t))}}})})}function isURLSearchParams(e){return"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&("URLSearchParams"===e.constructor.name||"[object URLSearchParams]"===Object.prototype.toString.call(e)||"function"==typeof e.sort)}function isBlob(e){return"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}function clone(e){let t,r;let n=e.body;if(e.bodyUsed)throw Error("cannot clone body after it is used");return n instanceof a&&"function"!=typeof n.getBoundary&&(t=new p,r=new p,n.pipe(t),n.pipe(r),e[f].body=t,n=r),n}function extractContentType(e){if(null===e)return null;if("string"==typeof e)return"text/plain;charset=UTF-8";if(isURLSearchParams(e))return"application/x-www-form-urlencoded;charset=UTF-8";if(isBlob(e))return e.type||null;if(Buffer.isBuffer(e))return null;if("[object ArrayBuffer]"===Object.prototype.toString.call(e))return null;if(ArrayBuffer.isView(e))return null;else if("function"==typeof e.getBoundary)return`multipart/form-data;boundary=${e.getBoundary()}`;else if(e instanceof a)return null;else return"text/plain;charset=UTF-8"}function getTotalBytes(e){let t=e.body;return null===t?0:isBlob(t)?t.size:Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync&&(t._lengthRetrievers&&0==t._lengthRetrievers.length||t.hasKnownLength&&t.hasKnownLength())?t.getLengthSync():null}Body.prototype={get body(){return this[f].body},get bodyUsed(){return this[f].disturbed},arrayBuffer(){return consumeBody.call(this).then(function(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)})},blob(){let e=this.headers&&this.headers.get("content-type")||"";return consumeBody.call(this).then(function(t){return Object.assign(new Blob([],{type:e.toLowerCase()}),{[d]:t})})},json(){var e=this;return consumeBody.call(this).then(function(t){try{return JSON.parse(t.toString())}catch(t){return Body.Promise.reject(new FetchError(`invalid json response body at ${e.url} reason: ${t.message}`,"invalid-json"))}})},text(){return consumeBody.call(this).then(function(e){return e.toString()})},buffer(){return consumeBody.call(this)},textConverted(){var e=this;return consumeBody.call(this).then(function(t){return function(e,t){let r,a;if("function"!=typeof n)throw Error("The package `encoding` must be installed to use the textConverted() function");let o=t.get("content-type"),i="utf-8";return o&&(r=/charset=([^;]*)/i.exec(o)),a=e.slice(0,1024).toString(),!r&&a&&(r=/<meta.+?charset=(['"])(.+?)\1/i.exec(a)),!r&&a&&(!(r=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(a))&&(r=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(a))&&r.pop(),r&&(r=/charset=(.*)/i.exec(r.pop()))),!r&&a&&(r=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(a)),r&&("gb2312"===(i=r.pop())||"gbk"===i)&&(i="gb18030"),n(e,"UTF-8",i).toString()}(t,e.headers)})}},Object.defineProperties(Body.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),Body.mixIn=function(e){for(let t of Object.getOwnPropertyNames(Body.prototype))if(!(t in e)){let r=Object.getOwnPropertyDescriptor(Body.prototype,t);Object.defineProperty(e,t,r)}},Body.Promise=global.Promise;let y=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,m=/[^\t\x20-\x7e\x80-\xff]/;function validateName(e){if(e=`${e}`,y.test(e)||""===e)throw TypeError(`${e} is not a legal HTTP header name`)}function validateValue(e){if(e=`${e}`,m.test(e))throw TypeError(`${e} is not a legal HTTP header value`)}function find(e,t){for(let r in t=t.toLowerCase(),e)if(r.toLowerCase()===t)return r}let g=Symbol("map");let Headers=class Headers{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[g]=Object.create(null),e instanceof Headers){let t=e.raw(),r=Object.keys(t);for(let e of r)for(let r of t[e])this.append(e,r);return}if(null==e);else if("object"==typeof e){let t=e[Symbol.iterator];if(null!=t){if("function"!=typeof t)throw TypeError("Header pairs must be iterable");let r=[];for(let t of e){if("object"!=typeof t||"function"!=typeof t[Symbol.iterator])throw TypeError("Each header pair must be iterable");r.push(Array.from(t))}for(let e of r){if(2!==e.length)throw TypeError("Each header pair must be a name/value tuple");this.append(e[0],e[1])}}else for(let t of Object.keys(e)){let r=e[t];this.append(t,r)}}else throw TypeError("Provided initializer must be an object")}get(e){validateName(e=`${e}`);let t=find(this[g],e);return void 0===t?null:this[g][t].join(", ")}forEach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=getHeaders(this),n=0;for(;n<r.length;){var a=r[n];let o=a[0],i=a[1];e.call(t,i,o,this),r=getHeaders(this),n++}}set(e,t){e=`${e}`,t=`${t}`,validateName(e),validateValue(t);let r=find(this[g],e);this[g][void 0!==r?r:e]=[t]}append(e,t){e=`${e}`,t=`${t}`,validateName(e),validateValue(t);let r=find(this[g],e);void 0!==r?this[g][r].push(t):this[g][e]=[t]}has(e){return validateName(e=`${e}`),void 0!==find(this[g],e)}delete(e){validateName(e=`${e}`);let t=find(this[g],e);void 0!==t&&delete this[g][t]}raw(){return this[g]}keys(){return createHeadersIterator(this,"key")}values(){return createHeadersIterator(this,"value")}[Symbol.iterator](){return createHeadersIterator(this,"key+value")}};function getHeaders(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key+value",r=Object.keys(e[g]).sort();return r.map("key"===t?function(e){return e.toLowerCase()}:"value"===t?function(t){return e[g][t].join(", ")}:function(t){return[t.toLowerCase(),e[g][t].join(", ")]})}Headers.prototype.entries=Headers.prototype[Symbol.iterator],Object.defineProperty(Headers.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(Headers.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});let b=Symbol("internal");function createHeadersIterator(e,t){let r=Object.create(w);return r[b]={target:e,kind:t,index:0},r}let w=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==w)throw TypeError("Value of `this` is not a HeadersIterator");var e=this[b];let t=e.target,r=e.kind,n=e.index,a=getHeaders(t,r),o=a.length;return n>=o?{value:void 0,done:!0}:(this[b].index=n+1,{value:a[n],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));Object.defineProperty(w,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});let v=Symbol("Response internals"),E=o.STATUS_CODES;let Response=class Response{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Body.call(this,e,t);let r=t.status||200,n=new Headers(t.headers);if(null!=e&&!n.has("Content-Type")){let t=extractContentType(e);t&&n.append("Content-Type",t)}this[v]={url:t.url,status:r,statusText:t.statusText||E[r],headers:n,counter:t.counter}}get url(){return this[v].url||""}get status(){return this[v].status}get ok(){return this[v].status>=200&&this[v].status<300}get redirected(){return this[v].counter>0}get statusText(){return this[v].statusText}get headers(){return this[v].headers}clone(){return new Response(clone(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}};Body.mixIn(Response.prototype),Object.defineProperties(Response.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(Response.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});let P=Symbol("Request internals"),R=i.URL||s.URL,T=i.parse,A=i.format;function parseURL(e){return/^[a-zA-Z][a-zA-Z\d+\-.]*:/.exec(e)&&(e=new R(e).toString()),T(e)}let S="destroy"in a.Readable.prototype;function isRequest(e){return"object"==typeof e&&"object"==typeof e[P]}let Request=class Request{constructor(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};isRequest(e)?t=parseURL(e.url):(t=e&&e.href?parseURL(e.href):parseURL(`${e}`),e={});let n=r.method||e.method||"GET";if(n=n.toUpperCase(),(null!=r.body||isRequest(e)&&null!==e.body)&&("GET"===n||"HEAD"===n))throw TypeError("Request with GET/HEAD method cannot have body");let a=null!=r.body?r.body:isRequest(e)&&null!==e.body?clone(e):null;Body.call(this,a,{timeout:r.timeout||e.timeout||0,size:r.size||e.size||0});let o=new Headers(r.headers||e.headers||{});if(null!=a&&!o.has("Content-Type")){let e=extractContentType(a);e&&o.append("Content-Type",e)}let i=isRequest(e)?e.signal:null;if("signal"in r&&(i=r.signal),null!=i&&!function(e){let t=e&&"object"==typeof e&&Object.getPrototypeOf(e);return!!(t&&"AbortSignal"===t.constructor.name)}(i))throw TypeError("Expected signal to be an instanceof AbortSignal");this[P]={method:n,redirect:r.redirect||e.redirect||"follow",headers:o,parsedURL:t,signal:i},this.follow=void 0!==r.follow?r.follow:void 0!==e.follow?e.follow:20,this.compress=void 0!==r.compress?r.compress:void 0===e.compress||e.compress,this.counter=r.counter||e.counter||0,this.agent=r.agent||e.agent}get method(){return this[P].method}get url(){return A(this[P].parsedURL)}get headers(){return this[P].headers}get redirect(){return this[P].redirect}get signal(){return this[P].signal}clone(){return new Request(this)}};function AbortError(e){Error.call(this,e),this.type="aborted",this.message=e,Error.captureStackTrace(this,this.constructor)}Body.mixIn(Request.prototype),Object.defineProperty(Request.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(Request.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}}),AbortError.prototype=Object.create(Error.prototype),AbortError.prototype.constructor=AbortError,AbortError.prototype.name="AbortError";let _=i.URL||s.URL,O=a.PassThrough,isDomainOrSubdomain=function(e,t){let r=new _(t).hostname,n=new _(e).hostname;return r===n||"."===r[r.length-n.length-1]&&r.endsWith(n)},isSameProtocol=function(e,t){let r=new _(t).protocol,n=new _(e).protocol;return r===n};function fetch(e,t){if(!fetch.Promise)throw Error("native promise missing, set fetch.Promise to your favorite alternative");return Body.Promise=fetch.Promise,new fetch.Promise(function(r,n){var i;let s,c;let d=new Request(e,t),h=function(e){let t=e[P].parsedURL,r=new Headers(e[P].headers);if(r.has("Accept")||r.set("Accept","*/*"),!t.protocol||!t.hostname)throw TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(t.protocol))throw TypeError("Only HTTP(S) protocols are supported");if(e.signal&&e.body instanceof a.Readable&&!S)throw Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let n=null;if(null==e.body&&/^(POST|PUT)$/i.test(e.method)&&(n="0"),null!=e.body){let t=getTotalBytes(e);"number"==typeof t&&(n=String(t))}n&&r.set("Content-Length",n),r.has("User-Agent")||r.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),e.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip,deflate");let o=e.agent;return"function"==typeof o&&(o=o(t)),Object.assign({},t,{method:e.method,headers:function(e){let t=Object.assign({__proto__:null},e[g]),r=find(e[g],"Host");return void 0!==r&&(t[r]=t[r][0]),t}(r),agent:o})}(d),f=("https:"===h.protocol?l:o).request,p=d.signal,b=null,abort=function(){let e=new AbortError("The user aborted a request.");n(e),d.body&&d.body instanceof a.Readable&&destroyStream(d.body,e),b&&b.body&&b.body.emit("error",e)};if(p&&p.aborted){abort();return}let abortAndFinalize=function(){abort(),finalize()},w=f(h);function finalize(){w.abort(),p&&p.removeEventListener("abort",abortAndFinalize),clearTimeout(s)}p&&p.addEventListener("abort",abortAndFinalize),d.timeout&&w.once("socket",function(e){s=setTimeout(function(){n(new FetchError(`network timeout at: ${d.url}`,"request-timeout")),finalize()},d.timeout)}),w.on("error",function(e){n(new FetchError(`request to ${d.url} failed, reason: ${e.message}`,"system",e)),b&&b.body&&destroyStream(b.body,e),finalize()}),i=function(e){(!p||!p.aborted)&&b&&b.body&&destroyStream(b.body,e)},w.on("socket",function(e){c=e}),w.on("response",function(e){let t=e.headers;"chunked"!==t["transfer-encoding"]||t["content-length"]||e.once("close",function(e){let t=c&&c.listenerCount("data")>0;if(t&&!e){let e=Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",i(e)}})}),14>parseInt(process.version.substring(1))&&w.on("socket",function(e){e.addListener("close",function(t){let r=e.listenerCount("data")>0;if(b&&r&&!t&&!(p&&p.aborted)){let e=Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",b.body.emit("error",e)}})}),w.on("response",function(e){clearTimeout(s);let t=function(e){let t=new Headers;for(let r of Object.keys(e))if(!y.test(r)){if(Array.isArray(e[r]))for(let n of e[r])m.test(n)||(void 0===t[g][r]?t[g][r]=[n]:t[g][r].push(n));else m.test(e[r])||(t[g][r]=[e[r]])}return t}(e.headers);if(fetch.isRedirect(e.statusCode)){let a=t.get("Location"),o=null;try{o=null===a?null:new _(a,d.url).toString()}catch(e){if("manual"!==d.redirect){n(new FetchError(`uri requested responds with an invalid redirect URL: ${a}`,"invalid-redirect")),finalize();return}}switch(d.redirect){case"error":n(new FetchError(`uri requested responds with a redirect, redirect mode is set to error: ${d.url}`,"no-redirect")),finalize();return;case"manual":if(null!==o)try{t.set("Location",o)}catch(e){n(e)}break;case"follow":if(null===o)break;if(d.counter>=d.follow){n(new FetchError(`maximum redirect reached at: ${d.url}`,"max-redirect")),finalize();return}let i={headers:new Headers(d.headers),follow:d.follow,counter:d.counter+1,agent:d.agent,compress:d.compress,method:d.method,body:d.body,signal:d.signal,timeout:d.timeout,size:d.size};if(!isDomainOrSubdomain(d.url,o)||!isSameProtocol(d.url,o))for(let e of["authorization","www-authenticate","cookie","cookie2"])i.headers.delete(e);if(303!==e.statusCode&&d.body&&null===getTotalBytes(d)){n(new FetchError("Cannot follow redirect with body being a readable stream","unsupported-redirect")),finalize();return}(303===e.statusCode||(301===e.statusCode||302===e.statusCode)&&"POST"===d.method)&&(i.method="GET",i.body=void 0,i.headers.delete("content-length")),r(fetch(new Request(o,i))),finalize();return}}e.once("end",function(){p&&p.removeEventListener("abort",abortAndFinalize)});let a=e.pipe(new O),o={url:d.url,status:e.statusCode,statusText:e.statusMessage,headers:t,size:d.size,timeout:d.timeout,counter:d.counter},i=t.get("Content-Encoding");if(!d.compress||"HEAD"===d.method||null===i||204===e.statusCode||304===e.statusCode){r(b=new Response(a,o));return}let l={flush:u.Z_SYNC_FLUSH,finishFlush:u.Z_SYNC_FLUSH};if("gzip"==i||"x-gzip"==i){a=a.pipe(u.createGunzip(l)),r(b=new Response(a,o));return}if("deflate"==i||"x-deflate"==i){let t=e.pipe(new O);t.once("data",function(e){a=(15&e[0])==8?a.pipe(u.createInflate()):a.pipe(u.createInflateRaw()),r(b=new Response(a,o))}),t.on("end",function(){b||r(b=new Response(a,o))});return}if("br"==i&&"function"==typeof u.createBrotliDecompress){a=a.pipe(u.createBrotliDecompress()),r(b=new Response(a,o));return}r(b=new Response(a,o))}),function(e,t){let r=t.body;null===r?e.end():isBlob(r)?r.stream().pipe(e):Buffer.isBuffer(r)?(e.write(r),e.end()):r.pipe(e)}(w,d)})}function destroyStream(e,t){e.destroy?e.destroy(t):(e.emit("error",t),e.end())}fetch.isRedirect=function(e){return 301===e||302===e||303===e||307===e||308===e},fetch.Promise=global.Promise,e.exports=t=fetch,Object.defineProperty(t,"__esModule",{value:!0}),t.default=t,t.Headers=Headers,t.Request=Request,t.Response=Response,t.FetchError=FetchError,t.AbortError=AbortError},5059:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{Z:()=>RebuffApi});var a=r(3815),o=r(8432),i=r(6113),s=r.n(i),l=e([o]);function generateCanaryWord(e=8){return s().randomBytes(e/2).toString("hex")}o=(l.then?(await l)():l)[0];let RebuffApi=class RebuffApi{constructor(e){this.apiToken=e.apiKey,this.apiUrl=e.apiUrl??"https://playground.rebuff.ai",this.headers={Authorization:`Bearer ${this.apiToken}`,"Content-Type":"application/json"}}async detectInjection({userInput:e="",maxHeuristicScore:t=.75,maxVectorScore:r=.9,maxModelScore:n=.9,runHeuristicCheck:i=!0,runVectorCheck:s=!0,runLanguageModelCheck:l=!0}){if(null===e)throw new a.J("userInput is required");let u={userInput:"",userInputBase64:Buffer.from(e,"utf-8").toString("hex"),runHeuristicCheck:i,runVectorCheck:s,runLanguageModelCheck:l,maxVectorScore:r,maxModelScore:n,maxHeuristicScore:t},c=await (0,o.ZP)(`${this.apiUrl}/api/detect`,{method:"POST",body:JSON.stringify(u),headers:this.headers}),d=await c.json();if(!c.ok)throw new a.J(d?.message);return d.injectionDetected=d.heuristicScore>t||d.modelScore>n||d.vectorScore.topScore>r,d}addCanaryWord(e,t=generateCanaryWord(),r="<!-- {canary_word} -->"){let n=r.replace("{canary_word}",t),a=`${n}
${e}`;return[a,t]}isCanaryWordLeaked(e,t,r,n=!0){return!!t.includes(r)&&(n&&this.logLeakage(e,{completion:t,canaryWord:r}),!0)}async logLeakage(e,t){let r=await (0,o.ZP)(`${this.apiUrl}/api/log`,{method:"POST",body:JSON.stringify({userInput:e,metaData:t}),headers:this.headers});if(!r.ok)throw Error(`HTTP error! status: ${r.status}`)}};n()}catch(e){n(e)}})},3430:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{J:()=>a.Z});var a=r(5059),o=r(1327),i=e([a,o]);[a,o]=i.then?(await i)():i,n()}catch(e){n(e)}})},3815:(e,t,r)=>{r.d(t,{J:()=>RebuffError});let RebuffError=class RebuffError extends Error{constructor(e){super(e),this.name="RebuffError"}}},3297:(e,t,r)=>{r(7747),function(){let e=["","prior","previous","preceding","above","foregoing","earlier","initial"],t=["","and start over","and start anew","and begin afresh","and start from scratch"],r=["content","text","instructions","instruction","directives","directive","commands","command","context","conversation","input","inputs","data","message","messages","communication","response","responses","request","requests"],n=[];for(let a of["Ignore","Disregard","Skip","Forget","Neglect","Overlook","Omit","Bypass","Pay no attention to","Do not follow","Do not obey"])for(let o of e)for(let e of r)for(let r of t)n.push(`${a} ${o} ${e} ${r}`.trim())}()},8182:(e,t,r)=>{r(3118)},7612:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(6991),a=r(3889);r(4379);var o=r(7607),i=e([n,a,o]);[n,a,o]=i.then?(await i)():i;t()}catch(e){t(e)}})},1327:(e,t,r)=>{r.a(e,async(e,t)=>{try{r(6113);var n=r(7612);r(3297),r(8182);var a=e([n]);n=(a.then?(await a)():a)[0],t()}catch(e){t(e)}})},8075:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{E:()=>BaseCallbackHandler});var a=r(6555),o=r(7021),i=e([a]);a=(i.then?(await i)():i)[0];let BaseCallbackHandlerMethodsClass=class BaseCallbackHandlerMethodsClass{};let BaseCallbackHandler=class BaseCallbackHandler extends BaseCallbackHandlerMethodsClass{get lc_namespace(){return["langchain","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,(0,o.j)(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:"undefined"==typeof process||process.env?.LANGCHAIN_CALLBACKS_BACKGROUND!=="true"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever)}copy(){return new this.constructor(this)}toJSON(){return o.i.prototype.toJSON.call(this)}toJSONNotImplemented(){return o.i.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){return new class extends BaseCallbackHandler{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:a.v4()}),Object.assign(this,e)}}}};n()}catch(e){n(e)}})},5310:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(6047),a=r(3572),o=e([a]);a=(o.then?(await o)():o)[0];let{color:i}=n;t()}catch(e){t(e)}})},4486:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(9091),a=r(2583),o=e([n,a]);[n,a]=o.then?(await o)():o,t()}catch(e){t(e)}})},3663:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(1851),a=r(3572),o=(r(7302),e([a]));a=(o.then?(await o)():o)[0];let RunLogPatch=class RunLogPatch{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops}concat(e){let t=this.ops.concat(e.ops),r=(0,n.af)({},t);return new RunLog({ops:t,state:r[r.length-1].newDocument})}};let RunLog=class RunLog extends RunLogPatch{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){let t=this.ops.concat(e.ops),r=(0,n.af)(this.state,e.ops);return new RunLog({ops:t,state:r[r.length-1].newDocument})}};a.Z,Symbol.asyncIterator,t()}catch(e){t(e)}})},3572:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{Z:()=>BaseTracer});var a=r(8075),o=e([a]);function _coerceToDict(e,t){return e&&!Array.isArray(e)&&"object"==typeof e?e:{[t]:e}}a=(o.then?(await o)():o)[0];let BaseTracer=class BaseTracer extends a.E{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}_addChildRun(e,t){e.child_runs.push(t)}async _startTrace(e){if(void 0!==e.parent_run_id){let t=this.runMap.get(e.parent_run_id);t&&(this._addChildRun(t,e),t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order))}this.runMap.set(e.id,e),await this.onRunCreate?.(e)}async _endTrace(e){let t=void 0!==e.parent_run_id&&this.runMap.get(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id),await this.onRunUpdate?.(e)}_getExecutionOrder(e){let t=void 0!==e&&this.runMap.get(e);return t?t.child_execution_order+1:1}async handleLLMStart(e,t,r,n,a,o,i,s){let l=this._getExecutionOrder(n),u=Date.now(),c=i?{...a,metadata:i}:a,d={id:r,name:s??e.id[e.id.length-1],parent_run_id:n,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:{prompts:t},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:c??{},tags:o||[]};return await this._startTrace(d),await this.onLLMStart?.(d),d}async handleChatModelStart(e,t,r,n,a,o,i,s){let l=this._getExecutionOrder(n),u=Date.now(),c=i?{...a,metadata:i}:a,d={id:r,name:s??e.id[e.id.length-1],parent_run_id:n,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:{messages:t},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:c??{},tags:o||[]};return await this._startTrace(d),await this.onLLMStart?.(d),d}async handleLLMEnd(e,t){let r=this.runMap.get(t);if(!r||r?.run_type!=="llm")throw Error("No LLM run to end.");return r.end_time=Date.now(),r.outputs=e,r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await this.onLLMEnd?.(r),await this._endTrace(r),r}async handleLLMError(e,t){let r=this.runMap.get(t);if(!r||r?.run_type!=="llm")throw Error("No LLM run to end.");return r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await this.onLLMError?.(r),await this._endTrace(r),r}async handleChainStart(e,t,r,n,a,o,i,s){let l=this._getExecutionOrder(n),u=Date.now(),c={id:r,name:s??e.id[e.id.length-1],parent_run_id:n,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:t,execution_order:l,child_execution_order:l,run_type:i??"chain",child_runs:[],extra:o?{metadata:o}:{},tags:a||[]};return await this._startTrace(c),await this.onChainStart?.(c),c}async handleChainEnd(e,t,r,n,a){let o=this.runMap.get(t);if(!o)throw Error("No chain run to end.");return o.end_time=Date.now(),o.outputs=_coerceToDict(e,"output"),o.events.push({name:"end",time:new Date(o.end_time).toISOString()}),a?.inputs!==void 0&&(o.inputs=_coerceToDict(a.inputs,"input")),await this.onChainEnd?.(o),await this._endTrace(o),o}async handleChainError(e,t,r,n,a){let o=this.runMap.get(t);if(!o)throw Error("No chain run to end.");return o.end_time=Date.now(),o.error=e.message,o.events.push({name:"error",time:new Date(o.end_time).toISOString()}),a?.inputs!==void 0&&(o.inputs=_coerceToDict(a.inputs,"input")),await this.onChainError?.(o),await this._endTrace(o),o}async handleToolStart(e,t,r,n,a,o,i){let s=this._getExecutionOrder(n),l=Date.now(),u={id:r,name:i??e.id[e.id.length-1],parent_run_id:n,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{input:t},execution_order:s,child_execution_order:s,run_type:"tool",child_runs:[],extra:o?{metadata:o}:{},tags:a||[]};return await this._startTrace(u),await this.onToolStart?.(u),u}async handleToolEnd(e,t){let r=this.runMap.get(t);if(!r||r?.run_type!=="tool")throw Error("No tool run to end");return r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await this.onToolEnd?.(r),await this._endTrace(r),r}async handleToolError(e,t){let r=this.runMap.get(t);if(!r||r?.run_type!=="tool")throw Error("No tool run to end");return r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await this.onToolError?.(r),await this._endTrace(r),r}async handleAgentAction(e,t){let r=this.runMap.get(t);r&&r?.run_type==="chain"&&(r.actions=r.actions||[],r.actions.push(e),r.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await this.onAgentAction?.(r))}async handleAgentEnd(e,t){let r=this.runMap.get(t);r&&r?.run_type==="chain"&&(r.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await this.onAgentEnd?.(r))}async handleRetrieverStart(e,t,r,n,a,o,i){let s=this._getExecutionOrder(n),l=Date.now(),u={id:r,name:i??e.id[e.id.length-1],parent_run_id:n,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{query:t},execution_order:s,child_execution_order:s,run_type:"retriever",child_runs:[],extra:o?{metadata:o}:{},tags:a||[]};return await this._startTrace(u),await this.onRetrieverStart?.(u),u}async handleRetrieverEnd(e,t){let r=this.runMap.get(t);if(!r||r?.run_type!=="retriever")throw Error("No retriever run to end");return r.end_time=Date.now(),r.outputs={documents:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await this.onRetrieverEnd?.(r),await this._endTrace(r),r}async handleRetrieverError(e,t){let r=this.runMap.get(t);if(!r||r?.run_type!=="retriever")throw Error("No retriever run to end");return r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await this.onRetrieverError?.(r),await this._endTrace(r),r}async handleText(e,t){let r=this.runMap.get(t);r&&r?.run_type==="chain"&&(r.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await this.onText?.(r))}async handleLLMNewToken(e,t,r,n,a,o){let i=this.runMap.get(r);if(!i||i?.run_type!=="llm")throw Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return i.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:t,chunk:o?.chunk}}),await this.onLLMNewToken?.(i,e),i}};n()}catch(e){n(e)}})},9091:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(1667),a=r(3572),o=e([n,a]);[n,a]=o.then?(await o)():o,t()}catch(e){t(e)}})},2583:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(3572),a=e([n]);n=(a.then?(await a)():a)[0],t()}catch(e){t(e)}})},4996:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(6555),a=r(8075),o=r(5310),i=r(4486),s=r(9091);r(330);var l=e([n,a,o,i,s]);[n,a,o,i,s]=l.then?(await l)():l;let CallbackManagerForRetrieverRun=class CallbackManagerForRetrieverRun extends null{getChild(e){let t=new CallbackManager(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{if(!t.ignoreRetriever)try{await t.handleRetrieverEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleRetriever`)}},t.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{if(!t.ignoreRetriever)try{await t.handleRetrieverError?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleRetrieverError: ${e}`)}},t.awaitHandlers)))}};let CallbackManagerForLLMRun=class CallbackManagerForLLMRun extends null{async handleLLMNewToken(e,t,r,n,a,o){await Promise.all(this.handlers.map(r=>consumeCallback(async()=>{if(!r.ignoreLLM)try{await r.handleLLMNewToken?.(e,t??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,o)}catch(e){console.error(`Error in handler ${r.constructor.name}, handleLLMNewToken: ${e}`)}},r.awaitHandlers)))}async handleLLMError(e){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{if(!t.ignoreLLM)try{await t.handleLLMError?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleLLMError: ${e}`)}},t.awaitHandlers)))}async handleLLMEnd(e){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{if(!t.ignoreLLM)try{await t.handleLLMEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleLLMEnd: ${e}`)}},t.awaitHandlers)))}};let CallbackManagerForChainRun=class CallbackManagerForChainRun extends null{getChild(e){let t=new CallbackManager(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e,t,r,n,a){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{if(!t.ignoreChain)try{await t.handleChainError?.(e,this.runId,this._parentRunId,this.tags,a)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleChainError: ${e}`)}},t.awaitHandlers)))}async handleChainEnd(e,t,r,n,a){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{if(!t.ignoreChain)try{await t.handleChainEnd?.(e,this.runId,this._parentRunId,this.tags,a)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleChainEnd: ${e}`)}},t.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{if(!t.ignoreAgent)try{await t.handleAgentAction?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleAgentAction: ${e}`)}},t.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{if(!t.ignoreAgent)try{await t.handleAgentEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleAgentEnd: ${e}`)}},t.awaitHandlers)))}};let CallbackManagerForToolRun=class CallbackManagerForToolRun extends null{getChild(e){let t=new CallbackManager(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{if(!t.ignoreAgent)try{await t.handleToolError?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleToolError: ${e}`)}},t.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{if(!t.ignoreAgent)try{await t.handleToolEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleToolEnd: ${e}`)}},t.awaitHandlers)))}};let CallbackManager=class CallbackManager extends null{constructor(e){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=[],this.inheritableHandlers=[],this._parentRunId=e}async handleLLMStart(e,t,r,n,a){return Promise.all(t.map(async t=>{let r=uuidv4();return await Promise.all(this.handlers.map(n=>consumeCallback(async()=>{if(!n.ignoreLLM)try{await n.handleLLMStart?.(e,[t],r,this._parentRunId,a,this.tags,this.metadata)}catch(e){console.error(`Error in handler ${n.constructor.name}, handleLLMStart: ${e}`)}},n.awaitHandlers))),new CallbackManagerForLLMRun(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,t,r,n,a){return Promise.all(t.map(async t=>{let r=uuidv4();return await Promise.all(this.handlers.map(n=>consumeCallback(async()=>{if(!n.ignoreLLM)try{if(n.handleChatModelStart)await n.handleChatModelStart?.(e,[t],r,this._parentRunId,a,this.tags,this.metadata);else if(n.handleLLMStart){let o=getBufferString(t);await n.handleLLMStart?.(e,[o],r,this._parentRunId,a,this.tags,this.metadata)}}catch(e){console.error(`Error in handler ${n.constructor.name}, handleLLMStart: ${e}`)}},n.awaitHandlers))),new CallbackManagerForLLMRun(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,t,r=uuidv4(),n){return await Promise.all(this.handlers.map(a=>consumeCallback(async()=>{if(!a.ignoreChain)try{await a.handleChainStart?.(e,t,r,this._parentRunId,this.tags,this.metadata,n)}catch(e){console.error(`Error in handler ${a.constructor.name}, handleChainStart: ${e}`)}},a.awaitHandlers))),new CallbackManagerForChainRun(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t,r=uuidv4()){return await Promise.all(this.handlers.map(n=>consumeCallback(async()=>{if(!n.ignoreAgent)try{await n.handleToolStart?.(e,t,r,this._parentRunId,this.tags,this.metadata)}catch(e){console.error(`Error in handler ${n.constructor.name}, handleToolStart: ${e}`)}},n.awaitHandlers))),new CallbackManagerForToolRun(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,t,r=uuidv4(),n){return await Promise.all(this.handlers.map(n=>consumeCallback(async()=>{if(!n.ignoreRetriever)try{await n.handleRetrieverStart?.(e,t,r,this._parentRunId,this.tags,this.metadata)}catch(e){console.error(`Error in handler ${n.constructor.name}, handleRetrieverStart: ${e}`)}},n.awaitHandlers))),new CallbackManagerForRetrieverRun(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}addHandler(e,t=!0){this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e),this.inheritableHandlers=this.inheritableHandlers.filter(t=>t!==e)}setHandlers(e,t=!0){for(let r of(this.handlers=[],this.inheritableHandlers=[],e))this.addHandler(r,t)}addTags(e,t=!0){this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(t=>!e.includes(t)),this.inheritableTags=this.inheritableTags.filter(t=>!e.includes(t))}addMetadata(e,t=!0){this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(let t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(e=[],t=!0){let r=new CallbackManager(this._parentRunId);for(let e of this.handlers){let t=this.inheritableHandlers.includes(e);r.addHandler(e,t)}for(let e of this.tags){let t=this.inheritableTags.includes(e);r.addTags([e],t)}for(let e of Object.keys(this.metadata)){let t=Object.keys(this.inheritableMetadata).includes(e);r.addMetadata({[e]:this.metadata[e]},t)}for(let n of e)r.handlers.filter(e=>"console_callback_handler"===e.name).some(e=>e.name===n.name)||r.addHandler(n,t);return r}static fromHandlers(e){let Handler=class Handler extends BaseCallbackHandler{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:uuidv4()}),Object.assign(this,e)}};let t=new this;return t.addHandler(new Handler),t}static async configure(e,t,r,n,a,o,i){let s;(e||t)&&(Array.isArray(e)||!e?(s=new CallbackManager).setHandlers(e?.map(ensureHandler)??[],!0):s=e,s=s.copy(Array.isArray(t)?t.map(ensureHandler):t?.handlers,!1));let l=getEnvironmentVariable("LANGCHAIN_VERBOSE")||i?.verbose,u="true"===getEnvironmentVariable("LANGCHAIN_TRACING_V2"),c=u||(getEnvironmentVariable("LANGCHAIN_TRACING")??!1);if(l||c){if(s||(s=new CallbackManager),l&&!s.handlers.some(e=>e.name===ConsoleCallbackHandler.prototype.name)){let e=new ConsoleCallbackHandler;s.addHandler(e,!0)}if(c&&!s.handlers.some(e=>"langchain_tracer"===e.name)){if(u)s.addHandler(await getTracingV2CallbackHandler(),!0);else{let e=getEnvironmentVariable("LANGCHAIN_PROJECT")&&getEnvironmentVariable("LANGCHAIN_SESSION");s.addHandler(await getTracingCallbackHandler(e),!0)}}}return(r||n)&&s&&(s.addTags(r??[]),s.addTags(n??[],!1)),(a||o)&&s&&(s.addMetadata(a??{}),s.addMetadata(o??{},!1)),s}};function ensureHandler(e){return"name"in e?e:BaseCallbackHandler.fromMethods(e)}t()}catch(e){t(e)}})},330:(e,t,r)=>{r(6998)},558:(e,t,r)=>{r(8957)},2187:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(7030);r(558);var a=r(5857),o=e([n,a]);[n,a]=o.then?(await o)():o,t()}catch(e){t(e)}})},7021:(e,t,r)=>{r.d(t,{i:()=>Serializable,j:()=>get_lc_unique_name});var n=r(7904);function keyToJson(e,t){return t?.[e]||n(e)}function shallowCopy(e){return Array.isArray(e)?[...e]:{...e}}function get_lc_unique_name(e){let t=Object.getPrototypeOf(e),r="function"==typeof e.lc_name&&("function"!=typeof t.lc_name||e.lc_name()!==t.lc_name());return r?e.lc_name():e.name}r(1615);let Serializable=class Serializable{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,get_lc_unique_name(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e,...t){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_kwargs=e||{}}toJSON(){if(!this.lc_serializable||this.lc_kwargs instanceof Serializable||"object"!=typeof this.lc_kwargs||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();let e={},t={},r=Object.keys(this.lc_kwargs).reduce((e,t)=>(e[t]=t in this?this[t]:this.lc_kwargs[t],e),{});for(let n=Object.getPrototypeOf(this);n;n=Object.getPrototypeOf(n))Object.assign(e,Reflect.get(n,"lc_aliases",this)),Object.assign(t,Reflect.get(n,"lc_secrets",this)),Object.assign(r,Reflect.get(n,"lc_attributes",this));return Object.keys(t).forEach(e=>{let t=this,n=r,[a,...o]=e.split(".").reverse();for(let e of o.reverse()){if(!(e in t)||void 0===t[e])return;e in n&&void 0!==n[e]||("object"==typeof t[e]&&null!=t[e]?n[e]={}:Array.isArray(t[e])&&(n[e]=[])),t=t[e],n=n[e]}a in t&&void 0!==t[a]&&(n[a]=n[a]||t[a])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:function(e,t,r){let n={};for(let a in e)Object.hasOwn(e,a)&&(n[t(a,r)]=e[a]);return n}(Object.keys(t).length?function(e,t){let r=shallowCopy(e);for(let[e,n]of Object.entries(t)){let[t,...a]=e.split(".").reverse(),o=r;for(let e of a.reverse()){if(void 0===o[e])break;o[e]=shallowCopy(o[e]),o=o[e]}void 0!==o[t]&&(o[t]={lc:1,type:"secret",id:[n]})}return r}(r,t):r,keyToJson,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}},4033:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(4996),a=r(2748),o=e([n,a]);[n,a]=o.then?(await o)():o,t()}catch(e){t(e)}})},6756:(e,t,r)=>{r.a(e,async(e,t)=>{try{r(1917);var n=r(4996),a=r(3663);r(7021),r(7302);var o=r(2481);r(8957);var i=e([n,a,o]);[n,a,o]=i.then?(await i)():i,t()}catch(e){t(e)}})},1008:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(6756),a=e([n]);n=(a.then?(await a)():a)[0],t()}catch(e){t(e)}})},2481:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(4996),a=e([n]);n=(a.then?(await a)():a)[0],t()}catch(e){t(e)}})},2748:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(6756),a=r(3565),o=r(9691),i=r(1008),s=e([n,a,o,i]);[n,a,o,i]=s.then?(await s)():s,t()}catch(e){t(e)}})},3565:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(6756),a=e([n]);n=(a.then?(await a)():a)[0],t()}catch(e){t(e)}})},9691:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(6756),a=e([n]);n=(a.then?(await a)():a)[0],t()}catch(e){t(e)}})},8957:(e,t,r)=>{r(1917),r(6998)},1851:(e,t,r)=>{r.d(t,{af:()=>applyPatch});var n={};r.r(n),r.d(n,{JsonPatchError:()=>o,_areEquals:()=>_areEquals,applyOperation:()=>applyOperation,applyPatch:()=>applyPatch,applyReducer:()=>applyReducer,deepClone:()=>i,getValueByPointer:()=>getValueByPointer,validate:()=>validate,validator:()=>validator});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */let a=Object.prototype.hasOwnProperty;function _deepClone(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function isInteger(e){let t,r=0,n=e.length;for(;r<n;){if((t=e.charCodeAt(r))>=48&&t<=57){r++;continue}return!1}return!0}function patchErrorMessageFormatter(e,t){let r=[e];for(let e in t){let n="object"==typeof t[e]?JSON.stringify(t[e],null,2):t[e];void 0!==n&&r.push(`${e}: ${n}`)}return r.join("\n")}let o=class extends Error{constructor(e,t,r,n,a){super(patchErrorMessageFormatter(e,{name:t,index:r,operation:n,tree:a})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.setPrototypeOf(this,new.target.prototype),this.message=patchErrorMessageFormatter(e,{name:t,index:r,operation:n,tree:a})}},i=_deepClone,s={add:function(e,t,r){return e[t]=this.value,{newDocument:r}},remove:function(e,t,r){var n=e[t];return delete e[t],{newDocument:r,removed:n}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:function(e,t,r){let n=getValueByPointer(r,this.path);n&&(n=_deepClone(n));let a=applyOperation(r,{op:"remove",path:this.from}).removed;return applyOperation(r,{op:"add",path:this.path,value:a}),{newDocument:r,removed:n}},copy:function(e,t,r){let n=getValueByPointer(r,this.from);return applyOperation(r,{op:"add",path:this.path,value:_deepClone(n)}),{newDocument:r}},test:function(e,t,r){return{newDocument:r,test:_areEquals(e[t],this.value)}},_get:function(e,t,r){return this.value=e[t],{newDocument:r}}};var l={add:function(e,t,r){return isInteger(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:r,index:t}},remove:function(e,t,r){return{newDocument:r,removed:e.splice(t,1)[0]}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:s.move,copy:s.copy,test:s.test,_get:s._get};function getValueByPointer(e,t){if(""==t)return e;var r={op:"_get",path:t};return applyOperation(e,r),r.value}function applyOperation(e,t,r=!1,n=!0,a=!0,i=0){if(r&&("function"==typeof r?r(t,0,e,t.path):validator(t,0)),""===t.path){let n={newDocument:e};if("add"===t.op)return n.newDocument=t.value,n;if("replace"===t.op)return n.newDocument=t.value,n.removed=e,n;if("move"===t.op||"copy"===t.op)return n.newDocument=getValueByPointer(e,t.from),"move"===t.op&&(n.removed=e),n;if("test"===t.op){if(n.test=_areEquals(e,t.value),!1===n.test)throw new o("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return n.newDocument=e,n}else{if("remove"===t.op)return n.removed=e,n.newDocument=null,n;if("_get"===t.op)return t.value=e,n;if(!r)return n;throw new o("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,t,e)}}{let u,c,d;n||(e=_deepClone(e));let h=t.path||"",f=h.split("/"),p=e,y=1,m=f.length;for(c="function"==typeof r?r:validator;;){if((u=f[y])&&-1!=u.indexOf("~")&&(u=u.replace(/~1/g,"/").replace(/~0/g,"~")),a&&("__proto__"==u||"prototype"==u&&y>0&&"constructor"==f[y-1]))throw TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(r&&void 0===d&&(void 0===p[u]?d=f.slice(0,y).join("/"):y==m-1&&(d=t.path),void 0!==d&&c(t,0,e,d)),y++,Array.isArray(p)){if("-"===u)u=p.length;else{if(r&&!isInteger(u))throw new o("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,t,e);isInteger(u)&&(u=~~u)}if(y>=m){if(r&&"add"===t.op&&u>p.length)throw new o("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,t,e);let n=l[t.op].call(t,p,u,e);if(!1===n.test)throw new o("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return n}}else if(y>=m){let r=s[t.op].call(t,p,u,e);if(!1===r.test)throw new o("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return r}if(p=p[u],r&&y<m&&(!p||"object"!=typeof p))throw new o("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",i,t,e)}}}function applyPatch(e,t,r,n=!0,a=!0){if(r&&!Array.isArray(t))throw new o("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(e=_deepClone(e));let i=Array(t.length);for(let n=0,o=t.length;n<o;n++)i[n]=applyOperation(e,t[n],r,!0,a,n),e=i[n].newDocument;return i.newDocument=e,i}function applyReducer(e,t,r){let n=applyOperation(e,t);if(!1===n.test)throw new o("Test operation failed","TEST_OPERATION_FAILED",r,t,e);return n.newDocument}function validator(e,t,r,n){if("object"!=typeof e||null===e||Array.isArray(e))throw new o("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,r);if(s[e.op]){if("string"!=typeof e.path)throw new o("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,r);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new o('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,r);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new o("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,r);else if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new o("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,r);else if(("add"===e.op||"replace"===e.op||"test"===e.op)&&function hasUndefined(e){if(void 0===e)return!0;if(e){if(Array.isArray(e)){for(let t=0,r=e.length;t<r;t++)if(hasUndefined(e[t]))return!0}else if("object"==typeof e){let r=function(e){if(Array.isArray(e)){let t=Array(e.length);for(let e=0;e<t.length;e++)t[e]=""+e;return t}if(Object.keys)return Object.keys(e);let t=[];for(let r in e)a.call(e,r)&&t.push(r);return t}(e),n=r.length;for(var t=0;t<n;t++)if(hasUndefined(e[r[t]]))return!0}}return!1}(e.value))throw new o("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,r);else if(r){if("add"==e.op){var i=e.path.split("/").length,l=n.split("/").length;if(i!==l+1&&i!==l)throw new o("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,r)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==n)throw new o("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,r)}else if("move"===e.op||"copy"===e.op){var u=validate([{op:"_get",path:e.from,value:void 0}],r);if(u&&"OPERATION_PATH_UNRESOLVABLE"===u.name)throw new o("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,r)}}}else throw new o("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,r)}function validate(e,t,r){try{if(!Array.isArray(e))throw new o("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)applyPatch(_deepClone(t),_deepClone(e),r||!0);else{r=r||validator;for(var n=0;n<e.length;n++)r(e[n],n,t,void 0)}}catch(e){if(e instanceof o)return e;throw e}}function _areEquals(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var r,n,a,o=Array.isArray(e),i=Array.isArray(t);if(o&&i){if((n=e.length)!=t.length)return!1;for(r=n;0!=r--;)if(!_areEquals(e[r],t[r]))return!1;return!0}if(o!=i)return!1;var s=Object.keys(e);if((n=s.length)!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!t.hasOwnProperty(s[r]))return!1;for(r=n;0!=r--;)if(!_areEquals(e[a=s[r]],t[a]))return!1;return!0}return e!=e&&t!=t}({...n})},5857:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(7030),a=e([n]);n=(a.then?(await a)():a)[0],t()}catch(e){t(e)}})},7302:(e,t,r)=>{r.d(t,{Q:()=>IterableReadableStream});let IterableReadableStream=class IterableReadableStream extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{let e=await this.reader.read();return e.done&&this.reader.releaseLock(),e}catch(e){throw this.reader.releaseLock(),e}}async return(){this.ensureReader();let e=this.reader.cancel();return this.reader.releaseLock(),await e,{done:!0,value:void 0}}[Symbol.asyncIterator](){return this}static fromReadableStream(e){let t=e.getReader();return new IterableReadableStream({start:e=>(function pump(){return t.read().then(({done:t,value:r})=>{if(t){e.close();return}return e.enqueue(r),pump()})})()})}static fromAsyncGenerator(e){return new IterableReadableStream({async pull(t){let{value:r,done:n}=await e.next();n?t.close():r&&t.enqueue(r)}})}}},3408:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(4033);r(7021);var a=e([n]);n=(a.then?(await a)():a)[0],t()}catch(e){t(e)}})},8357:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(6555),a=r(3408),o=e([n,a]);[n,a]=o.then?(await o)():o,t()}catch(e){t(e)}})},256:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(6555);r(5755);var a=r(3408);r(8957);var o=e([n,a]);[n,a]=o.then?(await o)():o,t()}catch(e){t(e)}})},6991:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(2187),a=e([n]);n=(a.then?(await a)():a)[0],t()}catch(e){t(e)}})},1253:(e,t,r)=>{r.d(t,{u:()=>getDefaultAgent});var n=r(9834),a=r(1030);let o=new n({keepAlive:!0,timeout:3e5}),i=new n.HttpsAgent({keepAlive:!0,timeout:3e5});"undefined"==typeof AbortController&&(AbortController=a.AbortController);let getDefaultAgent=e=>i&&e.startsWith("https")?i:o},7639:(e,t,r)=>{r.d(t,{hB:()=>o,he:()=>a});var n=r(8955);let a=n;n.Request,n.Response,n.Headers;let o=!0},9599:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{R:()=>fileFromPath});var a=r(7083),o=e([a]);a=(o.then?(await o)():o)[0];let i=!1;async function fileFromPath(e,...t){return i||(console.warn(`fileFromPath is deprecated; use fs.createReadStream(${JSON.stringify(e)}) instead`),i=!0),await (0,a.fileFromPath)(e,...t)}n()}catch(e){n(e)}})},1956:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{$B:()=>a.File,Ct:()=>a.FormData});var a=r(2962),o=e([a]);a=(o.then?(await o)():o)[0],n()}catch(e){n(e)}})},198:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{U:()=>getMultipartRequestOptions});var a=r(4492),o=r(5735),i=r(7675),s=e([o,i]);async function getMultipartRequestOptions(e,t){let r=new o.FormDataEncoder(e),n=a.Readable.from(r),s=new i.IO(n),l={...t.headers,...r.headers,"Content-Length":r.contentLength};return{...t,body:s,headers:l}}[o,i]=s.then?(await s)():s,n()}catch(e){n(e)}})},18:(e,t,r)=>{r.d(t,{Q:()=>isFsReadStream});var n=r(7561);function isFsReadStream(e){return e instanceof n.ReadStream}},4326:(e,t,r)=>{r.a(e,async(e,n)=>{try{let h;r.d(t,{FO:()=>AbstractPage,Fb:()=>isRunningInBrowser,WB:()=>readEnv,a1:()=>castToError,lP:()=>APIClient,md:()=>c.md,my:()=>isRequestOptions});var a,o=r(6387),i=r(8444),s=r(8388),l=r(1253),u=r(7639),c=r(7675),d=e([s,c]);[s,c]=d.then?(await d)():d;var __classPrivateFieldSet=function(e,t,r,n,a){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!a)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,r):a?a.value=r:t.set(e,r),r},__classPrivateFieldGet=function(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};async function defaultParseResponse(e){let{response:t}=e;if(e.options.stream)return new i.F(t,e.controller);let r=t.headers.get("content-type");if(null==r?void 0:r.includes("application/json")){let e=await t.json();return debug("response",t.status,t.url,t.headers,e),e}let n=await t.text();return debug("response",t.status,t.url,t.headers,n),n}let APIPromise=class APIPromise extends Promise{constructor(e,t=defaultParseResponse){super(e=>{e(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new APIPromise(this.responsePromise,async t=>e(await this.parseResponse(t)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}};let APIClient=class APIClient{constructor({baseURL:e,maxRetries:t,timeout:r=6e5,httpAgent:n,fetch:a}){this.baseURL=e,this.maxRetries=validatePositiveInteger("maxRetries",null!=t?t:2),this.timeout=validatePositiveInteger("timeout",r),this.httpAgent=n,this.fetch=null!=a?a:u.he}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...getPlatformHeaders(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${uuid4()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(r=>({method:e,path:t,...r})))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if("string"==typeof e){if("undefined"!=typeof Buffer)return Buffer.byteLength(e,"utf8").toString();if("undefined"!=typeof TextEncoder){let t=new TextEncoder,r=t.encode(e);return r.length.toString()}}return null}buildRequest(e){var t,r,n,a,o,i;let{method:s,path:d,query:h,headers:f={}}=e,p=(0,c.YT)(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,y=this.calculateContentLength(p),m=this.buildURL(d,h);"timeout"in e&&validatePositiveInteger("timeout",e.timeout);let g=null!==(t=e.timeout)&&void 0!==t?t:this.timeout,b=null!==(n=null!==(r=e.httpAgent)&&void 0!==r?r:this.httpAgent)&&void 0!==n?n:(0,l.u)(m),w=g+1e3;"number"==typeof(null===(a=null==b?void 0:b.options)||void 0===a?void 0:a.timeout)&&w>(null!==(o=b.options.timeout)&&void 0!==o?o:0)&&(b.options.timeout=w),this.idempotencyHeader&&"get"!==s&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),f[this.idempotencyHeader]=e.idempotencyKey);let v={...y&&{"Content-Length":y},...this.defaultHeaders(e),...f};(0,c.YT)(e.body)&&!u.hB&&delete v["Content-Type"],Object.keys(v).forEach(e=>null===v[e]&&delete v[e]);let E={method:s,...p&&{body:p},headers:v,...b&&{agent:b},signal:null!==(i=e.signal)&&void 0!==i?i:null};return this.validateHeaders(v,f),{req:E,url:m,timeout:g}}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(e=>[...e])):{...e}:{}}makeStatusError(e,t,r,n){return s.APIError.generate(e,t,r,n)}request(e,t=null){return new APIPromise(this.makeRequest(e,t))}async makeRequest(e,t){var r,n,a;let o=await e;null==t&&(t=null!==(r=o.maxRetries)&&void 0!==r?r:this.maxRetries);let{req:i,url:l,timeout:u}=this.buildRequest(o);if(await this.prepareRequest(i,{url:l,options:o}),debug("request",l,o,i.headers),null===(n=o.signal)||void 0===n?void 0:n.aborted)throw new s.APIUserAbortError;let c=new AbortController,d=await this.fetchWithTimeout(l,i,u,c).catch(castToError);if(d instanceof Error){if(null===(a=o.signal)||void 0===a?void 0:a.aborted)throw new s.APIUserAbortError;if(t)return this.retryRequest(o,t);if("AbortError"===d.name)throw new s.APIConnectionTimeoutError;throw new s.APIConnectionError({cause:d})}let h=createResponseHeaders(d.headers);if(!d.ok){if(t&&this.shouldRetry(d))return this.retryRequest(o,t,h);let e=await d.text().catch(()=>"Unknown"),r=safeJSON(e),n=r?void 0:e;debug("response",d.status,l,h,n);let a=this.makeStatusError(d.status,r,n,h);throw a}return{response:d,options:o,controller:c}}requestAPIList(e,t){let r=this.makeRequest(t,null);return new PagePromise(this,r,e)}buildURL(e,t){let r=new URL(isAbsoluteURL(e)?e:this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),n=this.defaultQuery();return isEmptyObj(n)||(t={...n,...t}),t&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([e,t])=>void 0!==t).map(([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw Error(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,n){let{signal:a,...o}=t||{};a&&a.addEventListener("abort",()=>n.abort());let i=setTimeout(()=>n.abort(),r);return this.getRequestClient().fetch(e,{signal:n.signal,...o}).finally(()=>{clearTimeout(i)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(409===e.status||429===e.status||e.status>=500)}async retryRequest(e,t,r){var n;t-=1;let a=parseInt((null==r?void 0:r["retry-after"])||""),o=null!==(n=e.maxRetries)&&void 0!==n?n:this.maxRetries,i=1e3*this.calculateRetryTimeoutSeconds(t,a,o);return await sleep(i),this.makeRequest(e,t)}calculateRetryTimeoutSeconds(e,t,r){return Number.isInteger(t)&&t<=60?t:Math.min(.5*Math.pow(r-e-1,2),2)+(Math.random()-.5)}getUserAgent(){return`${this.constructor.name}/JS ${o.q}`}};let AbstractPage=class AbstractPage{constructor(e,t,r,n){a.set(this,void 0),__classPrivateFieldSet(this,a,e,"f"),this.options=n,this.response=t,this.body=r}hasNextPage(){let e=this.getPaginatedItems();return!!e.length&&null!=this.nextPageInfo()}async getNextPage(){let e=this.nextPageInfo();if(!e)throw Error("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");let t={...this.options};if("params"in e)t.query={...t.query,...e.params};else if("url"in e){let r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(let[t,n]of r)e.url.searchParams.set(t,n);t.query=void 0,t.path=e.url.toString()}return await __classPrivateFieldGet(this,a,"f").requestAPIList(this.constructor,t)}async *iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async *[(a=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let t of e.getPaginatedItems())yield t}};let PagePromise=class PagePromise extends APIPromise{constructor(e,t,r){super(t,async t=>new r(e,t.response,await defaultParseResponse(t),t.options))}async *[Symbol.asyncIterator](){let e=await this;for await(let t of e)yield t}};let createResponseHeaders=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){let r=t.toString();return e[r.toLowerCase()]||e[r]}}),f={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0},isRequestOptions=e=>"object"==typeof e&&null!==e&&!isEmptyObj(e)&&Object.keys(e).every(e=>Object.prototype.hasOwnProperty.call(f,e)),getPlatformProperties=()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":o.q,"X-Stainless-OS":normalizePlatform(Deno.build.os),"X-Stainless-Arch":normalizeArch(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":Deno.version};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":o.q,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":o.q,"X-Stainless-OS":normalizePlatform(process.platform),"X-Stainless-Arch":normalizeArch(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};let e=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let r=t.exec(navigator.userAgent);if(r){let t=r[1]||0,n=r[2]||0,a=r[3]||0;return{browser:e,version:`${t}.${n}.${a}`}}}return null}();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":o.q,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":o.q,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}},normalizeArch=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",normalizePlatform=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown",getPlatformHeaders=()=>null!=h?h:h=getPlatformProperties(),safeJSON=e=>{try{return JSON.parse(e)}catch(e){return}},p=RegExp("^(?:[a-z]+:)?//","i"),isAbsoluteURL=e=>p.test(e),sleep=e=>new Promise(t=>setTimeout(t,e)),validatePositiveInteger=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw Error(`${e} must be an integer`);if(t<0)throw Error(`${e} must be a positive integer`);return t},castToError=e=>e instanceof Error?e:Error(e),readEnv=e=>{var t,r,n,a;return"undefined"!=typeof process?null!==(r=null===(t=process.env)||void 0===t?void 0:t[e])&&void 0!==r?r:void 0:"undefined"!=typeof Deno?null===(a=null===(n=Deno.env)||void 0===n?void 0:n.get)||void 0===a?void 0:a.call(n,e):void 0};function isEmptyObj(e){if(!e)return!0;for(let t in e)return!1;return!0}function debug(e,...t){"undefined"!=typeof process&&"true"===process.env.DEBUG&&console.log(`OpenAI:DEBUG:${e}`,...t)}let uuid4=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),isRunningInBrowser=()=>!1;n()}catch(e){n(e)}})},8388:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{APIConnectionError:()=>APIConnectionError,APIConnectionTimeoutError:()=>APIConnectionTimeoutError,APIError:()=>APIError,APIUserAbortError:()=>APIUserAbortError,AuthenticationError:()=>AuthenticationError,BadRequestError:()=>BadRequestError,ConflictError:()=>ConflictError,InternalServerError:()=>InternalServerError,NotFoundError:()=>NotFoundError,PermissionDeniedError:()=>PermissionDeniedError,RateLimitError:()=>RateLimitError,UnprocessableEntityError:()=>UnprocessableEntityError});var a=r(4326),o=e([a]);a=(o.then?(await o)():o)[0];let APIError=class APIError extends Error{constructor(e,t,r,n){super(APIError.makeMessage(t,r)),this.status=e,this.headers=n,this.error=t,this.code=null==t?void 0:t.code,this.param=null==t?void 0:t.param,this.type=null==t?void 0:t.type}static makeMessage(e,t){return(null==e?void 0:e.message)?"string"==typeof e.message?e.message:JSON.stringify(e.message):e?JSON.stringify(e):t||"Unknown error occurred"}static generate(e,t,r,n){if(!e)return new APIConnectionError({cause:(0,a.a1)(t)});let o=null==t?void 0:t.error;return 400===e?new BadRequestError(e,o,r,n):401===e?new AuthenticationError(e,o,r,n):403===e?new PermissionDeniedError(e,o,r,n):404===e?new NotFoundError(e,o,r,n):409===e?new ConflictError(e,o,r,n):422===e?new UnprocessableEntityError(e,o,r,n):429===e?new RateLimitError(e,o,r,n):e>=500?new InternalServerError(e,o,r,n):new APIError(e,o,r,n)}};let APIUserAbortError=class APIUserAbortError extends APIError{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}};let APIConnectionError=class APIConnectionError extends APIError{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,t&&(this.cause=t)}};let APIConnectionTimeoutError=class APIConnectionTimeoutError extends APIConnectionError{constructor(){super({message:"Request timed out."})}};let BadRequestError=class BadRequestError extends APIError{constructor(){super(...arguments),this.status=400}};let AuthenticationError=class AuthenticationError extends APIError{constructor(){super(...arguments),this.status=401}};let PermissionDeniedError=class PermissionDeniedError extends APIError{constructor(){super(...arguments),this.status=403}};let NotFoundError=class NotFoundError extends APIError{constructor(){super(...arguments),this.status=404}};let ConflictError=class ConflictError extends APIError{constructor(){super(...arguments),this.status=409}};let UnprocessableEntityError=class UnprocessableEntityError extends APIError{constructor(){super(...arguments),this.status=422}};let RateLimitError=class RateLimitError extends APIError{constructor(){super(...arguments),this.status=429}};let InternalServerError=class InternalServerError extends APIError{};n()}catch(e){n(e)}})},7030:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n,a=r(4326),o=r(616),i=r(3274),s=r(8388),l=r(7675),u=e([a,o,i,s,l]);[a,o,i,s,l]=u.then?(await u)():u;let OpenAI=class OpenAI extends a.lP{constructor(e){var t,r,{apiKey:n=a.WB("OPENAI_API_KEY"),organization:o=null!==(t=a.WB("OPENAI_ORG_ID"))&&void 0!==t?t:null,...s}=void 0===e?{}:e;if(void 0===n)throw Error("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'my apiKey' }).");let l={apiKey:n,organization:o,baseURL:"https://api.openai.com/v1",...s};if(!l.dangerouslyAllowBrowser&&a.Fb())throw Error("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:l.baseURL,timeout:null!==(r=l.timeout)&&void 0!==r?r:6e5,httpAgent:l.httpAgent,maxRetries:l.maxRetries,fetch:l.fetch}),this.completions=new i.cX(this),this.chat=new i.en(this),this.edits=new i.IK(this),this.embeddings=new i.JK(this),this.files=new i.hv(this),this.images=new i.rU(this),this.audio=new i.Bb(this),this.moderations=new i.kg(this),this.models=new i.kk(this),this.fineTuning=new i._4(this),this.fineTunes=new i.yp(this),this._options=l,this.apiKey=n,this.organization=o}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}};n=OpenAI,OpenAI.OpenAI=n,OpenAI.APIError=s.APIError,OpenAI.APIConnectionError=s.APIConnectionError,OpenAI.APIConnectionTimeoutError=s.APIConnectionTimeoutError,OpenAI.APIUserAbortError=s.APIUserAbortError,OpenAI.NotFoundError=s.NotFoundError,OpenAI.ConflictError=s.ConflictError,OpenAI.RateLimitError=s.RateLimitError,OpenAI.BadRequestError=s.BadRequestError,OpenAI.AuthenticationError=s.AuthenticationError,OpenAI.InternalServerError=s.InternalServerError,OpenAI.PermissionDeniedError=s.PermissionDeniedError,OpenAI.UnprocessableEntityError=s.UnprocessableEntityError;let{APIError:c,APIConnectionError:d,APIConnectionTimeoutError:h,APIUserAbortError:f,NotFoundError:p,ConflictError:y,RateLimitError:m,BadRequestError:g,AuthenticationError:b,InternalServerError:w,PermissionDeniedError:v,UnprocessableEntityError:E}=s;l.Vw,l.Rz,function(e){e.toFile=l.Vw,e.fileFromPath=l.Rz,e.Page=o.T,e.CursorPage=o.j,e.Completions=i.cX,e.Chat=i.en,e.Edits=i.IK,e.Embeddings=i.JK,e.Files=i.hv,e.FileObjectsPage=i.qw,e.Images=i.rU,e.Audio=i.Bb,e.Moderations=i.kg,e.Models=i.kk,e.ModelsPage=i.i4,e.FineTuning=i._4,e.FineTunes=i.yp,e.FineTunesPage=i.Ym}(OpenAI||(OpenAI={})),t()}catch(e){t(e)}})},616:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{T:()=>Page,j:()=>CursorPage});var a=r(4326),o=e([a]);a=(o.then?(await o)():o)[0];let Page=class Page extends a.FO{constructor(e,t,r,n){super(e,t,r,n),this.object=r.object,this.data=r.data}getPaginatedItems(){return this.data}nextPageParams(){return null}nextPageInfo(){return null}};let CursorPage=class CursorPage extends a.FO{constructor(e,t,r,n){super(e,t,r,n),this.data=r.data}getPaginatedItems(){return this.data}nextPageParams(){let e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;let t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var e,t;if(!(null===(e=this.data)||void 0===e?void 0:e.length))return null;let r=null===(t=this.data[this.data.length-1])||void 0===t?void 0:t.id;return r?{params:{after:r}}:null}};n()}catch(e){n(e)}})},8373:(e,t,r)=>{r.d(t,{T:()=>APIResource});let APIResource=class APIResource{constructor(e){this.client=e,this.get=e.get.bind(e),this.post=e.post.bind(e),this.patch=e.patch.bind(e),this.put=e.put.bind(e),this.delete=e.delete.bind(e),this.getAPIList=e.getAPIList.bind(e)}}},3221:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{B:()=>Audio});var a=r(8373),o=r(6004),i=r(908),s=r(7209),l=e([o,i,s]);[o,i,s]=l.then?(await l)():l;let Audio=class Audio extends a.T{constructor(){super(...arguments),this.transcriptions=new o.W(this.client),this.translations=new i.Z(this.client)}};(function(e){e.Transcriptions=s.Wb,e.Translations=s.ZT})(Audio||(Audio={})),n()}catch(e){n(e)}})},7209:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{Wb:()=>o.W,ZT:()=>i.Z});var a=r(3221),o=r(6004),i=r(908),s=e([a,o,i]);[a,o,i]=s.then?(await s)():s,n()}catch(e){n(e)}})},6004:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{W:()=>Transcriptions});var a=r(8373),o=r(4326),i=e([o]);o=(i.then?(await i)():i)[0];let Transcriptions=class Transcriptions extends a.T{create(e,t){return this.post("/audio/transcriptions",(0,o.md)({body:e,...t}))}};Transcriptions||(Transcriptions={}),n()}catch(e){n(e)}})},908:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{Z:()=>Translations});var a=r(8373),o=r(4326),i=e([o]);o=(i.then?(await i)():i)[0];let Translations=class Translations extends a.T{create(e,t){return this.post("/audio/translations",(0,o.md)({body:e,...t}))}};Translations||(Translations={}),n()}catch(e){n(e)}})},2627:(e,t,r)=>{r.d(t,{e:()=>Chat});var n=r(8373);let Completions=class Completions extends n.T{create(e,t){var r;return this.post("/chat/completions",{body:e,...t,stream:null!==(r=e.stream)&&void 0!==r&&r})}};Completions||(Completions={});let Chat=class Chat extends n.T{constructor(){super(...arguments),this.completions=new Completions(this.client)}};(Chat||(Chat={})).Completions=Completions},6528:(e,t,r)=>{r.d(t,{c:()=>Completions});var n=r(8373);let Completions=class Completions extends n.T{create(e,t){var r;return this.post("/completions",{body:e,...t,stream:null!==(r=e.stream)&&void 0!==r&&r})}};Completions||(Completions={})},3806:(e,t,r)=>{r.d(t,{I:()=>Edits});var n=r(8373);let Edits=class Edits extends n.T{create(e,t){return this.post("/edits",{body:e,...t})}};Edits||(Edits={})},2783:(e,t,r)=>{r.d(t,{J:()=>Embeddings});var n=r(8373);let Embeddings=class Embeddings extends n.T{create(e,t){return this.post("/embeddings",{body:e,...t})}};Embeddings||(Embeddings={})},3368:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{h:()=>Files,q:()=>FileObjectsPage});var a=r(8373),o=r(4326),i=r(616),s=e([o,i]);[o,i]=s.then?(await s)():s;let Files=class Files extends a.T{create(e,t){return this.post("/files",(0,o.md)({body:e,...t}))}retrieve(e,t){return this.get(`/files/${e}`,t)}list(e){return this.getAPIList("/files",FileObjectsPage,e)}del(e,t){return this.delete(`/files/${e}`,t)}retrieveContent(e,t){return this.get(`/files/${e}/content`,{...t,headers:{Accept:"application/json",...null==t?void 0:t.headers}})}};let FileObjectsPage=class FileObjectsPage extends i.T{};Files||(Files={}),n()}catch(e){n(e)}})},3600:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{Y:()=>FineTunesPage,y:()=>FineTunes});var a=r(8373),o=r(616),i=e([o]);o=(i.then?(await i)():i)[0];let FineTunes=class FineTunes extends a.T{create(e,t){return this.post("/fine-tunes",{body:e,...t})}retrieve(e,t){return this.get(`/fine-tunes/${e}`,t)}list(e){return this.getAPIList("/fine-tunes",FineTunesPage,e)}cancel(e,t){return this.post(`/fine-tunes/${e}/cancel`,t)}listEvents(e,t,r){var n;return this.get(`/fine-tunes/${e}/events`,{query:t,timeout:864e5,...r,stream:null!==(n=null==t?void 0:t.stream)&&void 0!==n&&n})}};let FineTunesPage=class FineTunesPage extends o.T{};FineTunes||(FineTunes={}),n()}catch(e){n(e)}})},8767:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{_:()=>FineTuning});var a=r(8373),o=r(9155),i=r(9261),s=e([o,i]);[o,i]=s.then?(await s)():s;let FineTuning=class FineTuning extends a.T{constructor(){super(...arguments),this.jobs=new o.pe(this.client)}};(function(e){e.Jobs=i.pe,e.FineTuningJobsPage=i.I8,e.FineTuningJobEventsPage=i.sM})(FineTuning||(FineTuning={})),n()}catch(e){n(e)}})},9261:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{I8:()=>o.I8,pe:()=>o.pe,sM:()=>o.sM});var a=r(8767),o=r(9155),i=e([a,o]);[a,o]=i.then?(await i)():i,n()}catch(e){n(e)}})},9155:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{I8:()=>FineTuningJobsPage,pe:()=>Jobs,sM:()=>FineTuningJobEventsPage});var a=r(8373),o=r(4326),i=r(616),s=e([o,i]);[o,i]=s.then?(await s)():s;let Jobs=class Jobs extends a.T{create(e,t){return this.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return(0,o.my)(e)?this.list({},e):this.getAPIList("/fine_tuning/jobs",FineTuningJobsPage,{query:e,...t})}cancel(e,t){return this.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return(0,o.my)(t)?this.listEvents(e,{},t):this.getAPIList(`/fine_tuning/jobs/${e}/events`,FineTuningJobEventsPage,{query:t,...r})}};let FineTuningJobsPage=class FineTuningJobsPage extends i.j{};let FineTuningJobEventsPage=class FineTuningJobEventsPage extends i.j{};Jobs||(Jobs={}),n()}catch(e){n(e)}})},7979:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{r:()=>Images});var a=r(8373),o=r(4326),i=e([o]);o=(i.then?(await i)():i)[0];let Images=class Images extends a.T{createVariation(e,t){return this.post("/images/variations",(0,o.md)({body:e,...t}))}edit(e,t){return this.post("/images/edits",(0,o.md)({body:e,...t}))}generate(e,t){return this.post("/images/generations",{body:e,...t})}};Images||(Images={}),n()}catch(e){n(e)}})},3274:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{Bb:()=>a.B,IK:()=>l.I,JK:()=>s.J,Ym:()=>c.Y,_4:()=>d._,cX:()=>i.c,en:()=>o.e,hv:()=>u.h,i4:()=>f.i,kg:()=>p.k,kk:()=>f.k,qw:()=>u.q,rU:()=>h.r,yp:()=>c.y});var a=r(3221),o=r(2627),i=r(6528),s=r(2783),l=r(3806),u=r(3368),c=r(3600),d=r(8767),h=r(7979),f=r(4537),p=r(8818),y=e([a,u,c,d,h,f]);[a,u,c,d,h,f]=y.then?(await y)():y,n()}catch(e){n(e)}})},4537:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{i:()=>ModelsPage,k:()=>Models});var a=r(8373),o=r(616),i=e([o]);o=(i.then?(await i)():i)[0];let Models=class Models extends a.T{retrieve(e,t){return this.get(`/models/${e}`,t)}list(e){return this.getAPIList("/models",ModelsPage,e)}del(e,t){return this.delete(`/models/${e}`,t)}};let ModelsPage=class ModelsPage extends o.T{};Models||(Models={}),n()}catch(e){n(e)}})},8818:(e,t,r)=>{r.d(t,{k:()=>Moderations});var n=r(8373);let Moderations=class Moderations extends n.T{create(e,t){return this.post("/moderations",{body:e,...t})}};Moderations||(Moderations={})},8444:(e,t,r)=>{r.d(t,{F:()=>Stream});let Stream=class Stream{constructor(e,t){this.response=e,this.controller=t,this.decoder=new SSEDecoder}async *iterMessages(){if(!this.response.body)throw this.controller.abort(),Error("Attempted to iterate over a response with no body");let e=new LineDecoder,t=function(e){if(e[Symbol.asyncIterator])return e;let t=e.getReader();return{async next(){try{let e=await t.read();return(null==e?void 0:e.done)&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){let e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}(this.response.body);for await(let r of t)for(let t of e.decode(r)){let e=this.decoder.decode(t);e&&(yield e)}for(let t of e.flush()){let e=this.decoder.decode(t);e&&(yield e)}}async *[Symbol.asyncIterator](){let e=!1;try{for await(let t of this.iterMessages())if(!e){if(t.data.startsWith("[DONE]")){e=!0;continue}if(null===t.event)try{yield JSON.parse(t.data)}catch(e){throw console.error("Could not parse message into JSON:",t.data),console.error("From chunk:",t.raw),e}}e=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{e||this.controller.abort()}}};let SSEDecoder=class SSEDecoder{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,n]=function(e,t){let r=e.indexOf(t);return -1!==r?[e.substring(0,r),t,e.substring(r+t.length)]:[e,"",""]}(e,":");return n.startsWith(" ")&&(n=n.substring(1)),"event"===t?this.event=n:"data"===t&&this.data.push(n),null}};let LineDecoder=class LineDecoder{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];let r=LineDecoder.NEWLINE_CHARS.has(t[t.length-1]||""),n=t.split(LineDecoder.NEWLINE_REGEXP);return 1!==n.length||r?(this.buffer.length>0&&(n=[this.buffer.join("")+n[0],...n.slice(1)],this.buffer=[]),r||(this.buffer=[n.pop()||""]),n):(this.buffer.push(n[0]),[])}decodeText(e){var t;if(null==e)return"";if("string"==typeof e)return e;if("undefined"!=typeof Buffer){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw Error(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return null!==(t=this.textDecoder)&&void 0!==t||(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw Error(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw Error("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];let e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}};LineDecoder.NEWLINE_CHARS=new Set(["\n","\r","\v","\f","\x1c","\x1d","\x1e","\x85","\u2028","\u2029"]),LineDecoder.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g},7675:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{IO:()=>MultipartBody,Rz:()=>i.R,Vw:()=>toFile,YT:()=>isMultipartBody,md:()=>multipartFormRequestOptions});var a=r(1956),o=r(198),i=r(9599),s=r(18),l=e([a,o,i]);[a,o,i]=l.then?(await l)():l;let isResponseLike=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob,isFileLike=e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&isBlobLike(e),isBlobLike=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer,isUploadable=e=>isFileLike(e)||isResponseLike(e)||(0,s.Q)(e);async function toFile(e,t,r={}){var n,o,i,s,l;if(e=await e,isResponseLike(e)){let o=await e.blob();return t||(t=null!==(n=new URL(e.url).pathname.split(/[\\/]/).pop())&&void 0!==n?n:"unknown_file"),new a.$B([o],t,r)}let u=await getBytes(e);if(t||(t=null!==(s=e,o=getStringFromMaybeBuffer(s.name)||getStringFromMaybeBuffer(s.filename)||(null===(l=getStringFromMaybeBuffer(s.path))||void 0===l?void 0:l.split(/[\\/]/).pop()))&&void 0!==o?o:"unknown_file"),!r.type){let e=null===(i=u[0])||void 0===i?void 0:i.type;"string"==typeof e&&(r={...r,type:e})}return new a.$B(u,t,r)}async function getBytes(e){var t;let r=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)r.push(e);else if(isBlobLike(e))r.push(await e.arrayBuffer());else if(isAsyncIterableIterator(e))for await(let t of e)r.push(t);else throw Error(`Unexpected data type: ${typeof e}; constructor: ${null===(t=null==e?void 0:e.constructor)||void 0===t?void 0:t.name}; props: ${function(e){let t=Object.getOwnPropertyNames(e);return`[${t.map(e=>`"${e}"`).join(", ")}]`}(e)}`);return r}let getStringFromMaybeBuffer=e=>"string"==typeof e?e:"undefined"!=typeof Buffer&&e instanceof Buffer?String(e):void 0,isAsyncIterableIterator=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator];let MultipartBody=class MultipartBody{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}};let isMultipartBody=e=>e&&"object"==typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag],multipartFormRequestOptions=async e=>{let t=await createForm(e.body);return(0,o.U)(t,e)},createForm=async e=>{let t=new a.Ct;return await Promise.all(Object.entries(e||{}).map(([e,r])=>addFormValue(t,e,r))),t},addFormValue=async(e,t,r)=>{if(void 0!==r){if(null==r)throw TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof r||"number"==typeof r||"boolean"==typeof r)e.append(t,String(r));else if(isUploadable(r)){let n=await toFile(r);e.append(t,n)}else if(Array.isArray(r))await Promise.all(r.map(r=>addFormValue(e,t+"[]",r)));else if("object"==typeof r)await Promise.all(Object.entries(r).map(([r,n])=>addFormValue(e,`${t}[${r}]`,n)));else throw TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}};n()}catch(e){n(e)}})},6387:(e,t,r)=>{r.d(t,{q:()=>n});let n="4.4.0"},7607:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(8357),a=e([n]);n=(a.then?(await a)():a)[0],t()}catch(e){t(e)}})},3889:(e,t,r)=>{r.a(e,async(e,t)=>{try{var n=r(256),a=e([n]);n=(a.then?(await a)():a)[0],t()}catch(e){t(e)}})},3690:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{K1:()=>writeToStream,NV:()=>getTotalBytes,Vl:()=>extractContentType,ZP:()=>Body,d9:()=>clone});var a=r(4492),o=r(7261),i=r(2254),s=r(4091),l=r(1691),u=r(9103),c=r(5807),d=r(8204),h=e([s,l]);[s,l]=h.then?(await h)():h;let f=(0,o.promisify)(a.pipeline),p=Symbol("Body internals");let Body=class Body{constructor(e,{size:t=0}={}){let r=null;null===e?e=null:(0,d.SB)(e)?e=i.Buffer.from(e.toString()):(0,d.Lj)(e)||i.Buffer.isBuffer(e)||(o.types.isAnyArrayBuffer(e)?e=i.Buffer.from(e):ArrayBuffer.isView(e)?e=i.Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof a||(e instanceof l.FormData?r=(e=(0,l.formDataToBlob)(e)).type.split("=")[1]:e=i.Buffer.from(String(e))));let n=e;i.Buffer.isBuffer(e)?n=a.Readable.from(e):(0,d.Lj)(e)&&(n=a.Readable.from(e.stream())),this[p]={body:e,stream:n,boundary:r,disturbed:!1,error:null},this.size=t,e instanceof a&&e.on("error",e=>{let t=e instanceof c.f?e:new u.k(`Invalid response body while trying to fetch ${this.url}: ${e.message}`,"system",e);this[p].error=t})}get body(){return this[p].stream}get bodyUsed(){return this[p].disturbed}async arrayBuffer(){let{buffer:e,byteOffset:t,byteLength:r}=await consumeBody(this);return e.slice(t,t+r)}async formData(){let e=this.headers.get("content-type");if(e.startsWith("application/x-www-form-urlencoded")){let e=new l.FormData,t=new URLSearchParams(await this.text());for(let[r,n]of t)e.append(r,n);return e}let{toFormData:t}=await r.e(63).then(r.bind(r,7063));return t(this.body,e)}async blob(){let e=this.headers&&this.headers.get("content-type")||this[p].body&&this[p].body.type||"",t=await this.arrayBuffer();return new s.default([t],{type:e})}async json(){let e=await this.text();return JSON.parse(e)}async text(){let e=await consumeBody(this);return new TextDecoder().decode(e)}buffer(){return consumeBody(this)}};async function consumeBody(e){if(e[p].disturbed)throw TypeError(`body used already for: ${e.url}`);if(e[p].disturbed=!0,e[p].error)throw e[p].error;let{body:t}=e;if(null===t||!(t instanceof a))return i.Buffer.alloc(0);let r=[],n=0;try{for await(let a of t){if(e.size>0&&n+a.length>e.size){let r=new u.k(`content size at ${e.url} over limit: ${e.size}`,"max-size");throw t.destroy(r),r}n+=a.length,r.push(a)}}catch(r){let t=r instanceof c.f?r:new u.k(`Invalid response body while trying to fetch ${e.url}: ${r.message}`,"system",r);throw t}if(!0===t.readableEnded||!0===t._readableState.ended)try{if(r.every(e=>"string"==typeof e))return i.Buffer.from(r.join(""));return i.Buffer.concat(r,n)}catch(t){throw new u.k(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t)}else throw new u.k(`Premature close of server response while trying to fetch ${e.url}`)}Body.prototype.buffer=(0,o.deprecate)(Body.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer"),Object.defineProperties(Body.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:(0,o.deprecate)(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});let clone=(e,t)=>{let r,n;let{body:o}=e[p];if(e.bodyUsed)throw Error("cannot clone body after it is used");return o instanceof a&&"function"!=typeof o.getBoundary&&(r=new a.PassThrough({highWaterMark:t}),n=new a.PassThrough({highWaterMark:t}),o.pipe(r),o.pipe(n),e[p].stream=r,o=n),o},y=(0,o.deprecate)(e=>e.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),extractContentType=(e,t)=>null===e?null:"string"==typeof e?"text/plain;charset=UTF-8":(0,d.SB)(e)?"application/x-www-form-urlencoded;charset=UTF-8":(0,d.Lj)(e)?e.type||null:i.Buffer.isBuffer(e)||o.types.isAnyArrayBuffer(e)||ArrayBuffer.isView(e)?null:e instanceof l.FormData?`multipart/form-data; boundary=${t[p].boundary}`:e&&"function"==typeof e.getBoundary?`multipart/form-data;boundary=${y(e)}`:e instanceof a?null:"text/plain;charset=UTF-8",getTotalBytes=e=>{let{body:t}=e[p];return null===t?0:(0,d.Lj)(t)?t.size:i.Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync&&t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null},writeToStream=async(e,{body:t})=>{null===t?e.end():await f(t,e)};n()}catch(e){n(e)}})},2102:(e,t,r)=>{r.d(t,{_:()=>AbortError});var n=r(5807);let AbortError=class AbortError extends n.f{constructor(e,t="aborted"){super(e,t)}}},5807:(e,t,r)=>{r.d(t,{f:()=>FetchBaseError});let FetchBaseError=class FetchBaseError extends Error{constructor(e,t){super(e),Error.captureStackTrace(this,this.constructor),this.type=t}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}}},9103:(e,t,r)=>{r.d(t,{k:()=>FetchError});var n=r(5807);let FetchError=class FetchError extends n.f{constructor(e,t,r){super(e,t),r&&(this.code=this.errno=r.code,this.erroredSysCall=r.syscall)}}},5111:(e,t,r)=>{r.d(t,{Z:()=>Headers,x:()=>fromRawHeaders});var n=r(7261),a=r(8849);let o="function"==typeof a.validateHeaderName?a.validateHeaderName:e=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(e)){let t=TypeError(`Header name must be a valid HTTP token [${e}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},i="function"==typeof a.validateHeaderValue?a.validateHeaderValue:(e,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){let t=TypeError(`Invalid character in header content ["${e}"]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_CHAR"}),t}};let Headers=class Headers extends URLSearchParams{constructor(e){let t=[];if(e instanceof Headers){let r=e.raw();for(let[e,n]of Object.entries(r))t.push(...n.map(t=>[e,t]))}else if(null==e);else if("object"!=typeof e||n.types.isBoxedPrimitive(e))throw TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");else{let r=e[Symbol.iterator];if(null==r)t.push(...Object.entries(e));else{if("function"!=typeof r)throw TypeError("Header pairs must be iterable");t=[...e].map(e=>{if("object"!=typeof e||n.types.isBoxedPrimitive(e))throw TypeError("Each header pair must be an iterable object");return[...e]}).map(e=>{if(2!==e.length)throw TypeError("Each header pair must be a name/value tuple");return[...e]})}}return super(t=t.length>0?t.map(([e,t])=>(o(e),i(e,String(t)),[String(e).toLowerCase(),String(t)])):void 0),new Proxy(this,{get(e,t,r){switch(t){case"append":case"set":return(r,n)=>(o(r),i(r,String(n)),URLSearchParams.prototype[t].call(e,String(r).toLowerCase(),String(n)));case"delete":case"has":case"getAll":return r=>(o(r),URLSearchParams.prototype[t].call(e,String(r).toLowerCase()));case"keys":return()=>(e.sort(),new Set(URLSearchParams.prototype.keys.call(e)).keys());default:return Reflect.get(e,t,r)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(e){let t=this.getAll(e);if(0===t.length)return null;let r=t.join(", ");return/^content-encoding$/i.test(e)&&(r=r.toLowerCase()),r}forEach(e,t){for(let r of this.keys())Reflect.apply(e,t,[this.get(r),r,this])}*values(){for(let e of this.keys())yield this.get(e)}*entries(){for(let e of this.keys())yield[e,this.get(e)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((e,t)=>(e[t]=this.getAll(t),e),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((e,t)=>{let r=this.getAll(t);return"host"===t?e[t]=r[0]:e[t]=r.length>1?r:r[0],e},{})}};function fromRawHeaders(e=[]){return new Headers(e.reduce((e,t,r,n)=>(r%2==0&&e.push(n.slice(r,r+2)),e),[]).filter(([e,t])=>{try{return o(e),i(e,String(t)),!0}catch{return!1}}))}Object.defineProperties(Headers.prototype,["get","entries","forEach","values"].reduce((e,t)=>(e[t]={enumerable:!0},e),{}))},8432:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{ZP:()=>fetch});var a=r(8849),o=r(2286),i=r(5628),s=r(4492),l=r(2254),u=r(1168),c=r(3690),d=r(9464),h=r(5111),f=r(8753),p=r(9103),y=r(2102),m=r(7274),g=r(1691),b=r(8204),w=r(9456),v=r(1034),E=e([u,g,v,f,d,c]);[u,g,v,f,d,c]=E.then?(await E)():E;let P=new Set(["data:","http:","https:"]);async function fetch(e,t){return new Promise((r,n)=>{let g=new f.Z(e,t),{parsedURL:v,options:E}=(0,f.R)(g);if(!P.has(v.protocol))throw TypeError(`node-fetch cannot load ${e}. URL scheme "${v.protocol.replace(/:$/,"")}" is not supported.`);if("data:"===v.protocol){let e=(0,u.default)(g.url),t=new d.Z(e,{headers:{"Content-Type":e.typeFull}});r(t);return}let R=("https:"===v.protocol?o:a).request,{signal:T}=g,A=null,abort=()=>{let e=new y._("The operation was aborted.");n(e),g.body&&g.body instanceof s.Readable&&g.body.destroy(e),A&&A.body&&A.body.emit("error",e)};if(T&&T.aborted){abort();return}let abortAndFinalize=()=>{abort(),finalize()},S=R(v.toString(),E);T&&T.addEventListener("abort",abortAndFinalize);let finalize=()=>{S.abort(),T&&T.removeEventListener("abort",abortAndFinalize)};S.on("error",e=>{n(new p.k(`request to ${g.url} failed, reason: ${e.message}`,"system",e)),finalize()}),function(e,t){let r;let n=l.Buffer.from("0\r\n\r\n"),a=!1,o=!1;e.on("response",e=>{let{headers:t}=e;a="chunked"===t["transfer-encoding"]&&!t["content-length"]}),e.on("socket",i=>{let onSocketClose=()=>{if(a&&!o){let e=Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",t(e)}},onData=e=>{(o=0===l.Buffer.compare(e.slice(-5),n))||!r||(o=0===l.Buffer.compare(r.slice(-3),n.slice(0,3))&&0===l.Buffer.compare(e.slice(-2),n.slice(3))),r=e};i.prependListener("close",onSocketClose),i.on("data",onData),e.on("close",()=>{i.removeListener("close",onSocketClose),i.removeListener("data",onData)})})}(S,e=>{A&&A.body&&A.body.destroy(e)}),process.version<"v14"&&S.on("socket",e=>{let t;e.prependListener("end",()=>{t=e._eventsCount}),e.prependListener("close",r=>{if(A&&t<e._eventsCount&&!r){let e=Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",A.body.emit("error",e)}})}),S.on("response",e=>{S.setTimeout(0);let a=(0,h.x)(e.rawHeaders);if((0,m.x)(e.statusCode)){let o=a.get("Location"),i=null;try{i=null===o?null:new URL(o,g.url)}catch{if("manual"!==g.redirect){n(new p.k(`uri requested responds with an invalid redirect URL: ${o}`,"invalid-redirect")),finalize();return}}switch(g.redirect){case"error":n(new p.k(`uri requested responds with a redirect, redirect mode is set to error: ${g.url}`,"no-redirect")),finalize();return;case"manual":break;case"follow":{if(null===i)break;if(g.counter>=g.follow){n(new p.k(`maximum redirect reached at: ${g.url}`,"max-redirect")),finalize();return}let o={headers:new h.Z(g.headers),follow:g.follow,counter:g.counter+1,agent:g.agent,compress:g.compress,method:g.method,body:(0,c.d9)(g),signal:g.signal,size:g.size,referrer:g.referrer,referrerPolicy:g.referrerPolicy};if(!(0,b.JN)(g.url,i)||!(0,b.eL)(g.url,i))for(let e of["authorization","www-authenticate","cookie","cookie2"])o.headers.delete(e);if(303!==e.statusCode&&g.body&&t.body instanceof s.Readable){n(new p.k("Cannot follow redirect with body being a readable stream","unsupported-redirect")),finalize();return}(303===e.statusCode||(301===e.statusCode||302===e.statusCode)&&"POST"===g.method)&&(o.method="GET",o.body=void 0,o.headers.delete("content-length"));let l=(0,w.Cc)(a);l&&(o.referrerPolicy=l),r(fetch(new f.Z(i,o))),finalize();return}default:return n(TypeError(`Redirect option '${g.redirect}' is not a valid value of RequestRedirect`))}}T&&e.once("end",()=>{T.removeEventListener("abort",abortAndFinalize)});let o=(0,s.pipeline)(e,new s.PassThrough,e=>{e&&n(e)});process.version<"v12.10"&&e.on("aborted",abortAndFinalize);let l={url:g.url,status:e.statusCode,statusText:e.statusMessage,headers:a,size:g.size,counter:g.counter,highWaterMark:g.highWaterMark},u=a.get("Content-Encoding");if(!g.compress||"HEAD"===g.method||null===u||204===e.statusCode||304===e.statusCode){A=new d.Z(o,l),r(A);return}let y={flush:i.Z_SYNC_FLUSH,finishFlush:i.Z_SYNC_FLUSH};if("gzip"===u||"x-gzip"===u){o=(0,s.pipeline)(o,i.createGunzip(y),e=>{e&&n(e)}),A=new d.Z(o,l),r(A);return}if("deflate"===u||"x-deflate"===u){let t=(0,s.pipeline)(e,new s.PassThrough,e=>{e&&n(e)});t.once("data",e=>{o=(15&e[0])==8?(0,s.pipeline)(o,i.createInflate(),e=>{e&&n(e)}):(0,s.pipeline)(o,i.createInflateRaw(),e=>{e&&n(e)}),A=new d.Z(o,l),r(A)}),t.once("end",()=>{A||(A=new d.Z(o,l),r(A))});return}if("br"===u){o=(0,s.pipeline)(o,i.createBrotliDecompress(),e=>{e&&n(e)}),A=new d.Z(o,l),r(A);return}A=new d.Z(o,l),r(A)}),(0,c.K1)(S,g).catch(n)})}n()}catch(e){n(e)}})},8753:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{R:()=>getNodeRequestOptions,Z:()=>Request});var a=r(1041),o=r(7261),i=r(5111),s=r(3690),l=r(8204),u=r(1138),c=r(9456),d=e([s]);s=(d.then?(await d)():d)[0];let h=Symbol("Request internals"),isRequest=e=>"object"==typeof e&&"object"==typeof e[h],f=(0,o.deprecate)(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)");let Request=class Request extends s.ZP{constructor(e,t={}){let r;if(isRequest(e)?r=new URL(e.url):(r=new URL(e),e={}),""!==r.username||""!==r.password)throw TypeError(`${r} is an url with embedded credentials.`);let n=t.method||e.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(n)&&(n=n.toUpperCase()),!isRequest(t)&&"data"in t&&f(),(null!=t.body||isRequest(e)&&null!==e.body)&&("GET"===n||"HEAD"===n))throw TypeError("Request with GET/HEAD method cannot have body");let a=t.body?t.body:isRequest(e)&&null!==e.body?(0,s.d9)(e):null;super(a,{size:t.size||e.size||0});let o=new i.Z(t.headers||e.headers||{});if(null!==a&&!o.has("Content-Type")){let e=(0,s.Vl)(a,this);e&&o.set("Content-Type",e)}let u=isRequest(e)?e.signal:null;if("signal"in t&&(u=t.signal),null!=u&&!(0,l.O0)(u))throw TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let c=null==t.referrer?e.referrer:t.referrer;if(""===c)c="no-referrer";else if(c){let e=new URL(c);c=/^about:(\/\/)?client$/.test(e)?"client":e}else c=void 0;this[h]={method:n,redirect:t.redirect||e.redirect||"follow",headers:o,parsedURL:r,signal:u,referrer:c},this.follow=void 0===t.follow?void 0===e.follow?20:e.follow:t.follow,this.compress=void 0===t.compress?void 0===e.compress||e.compress:t.compress,this.counter=t.counter||e.counter||0,this.agent=t.agent||e.agent,this.highWaterMark=t.highWaterMark||e.highWaterMark||16384,this.insecureHTTPParser=t.insecureHTTPParser||e.insecureHTTPParser||!1,this.referrerPolicy=t.referrerPolicy||e.referrerPolicy||""}get method(){return this[h].method}get url(){return(0,a.format)(this[h].parsedURL)}get headers(){return this[h].headers}get redirect(){return this[h].redirect}get signal(){return this[h].signal}get referrer(){return"no-referrer"===this[h].referrer?"":"client"===this[h].referrer?"about:client":this[h].referrer?this[h].referrer.toString():void 0}get referrerPolicy(){return this[h].referrerPolicy}set referrerPolicy(e){this[h].referrerPolicy=(0,c.vr)(e)}clone(){return new Request(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(Request.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});let getNodeRequestOptions=e=>{let{parsedURL:t}=e[h],r=new i.Z(e[h].headers);r.has("Accept")||r.set("Accept","*/*");let n=null;if(null===e.body&&/^(post|put)$/i.test(e.method)&&(n="0"),null!==e.body){let t=(0,s.NV)(e);"number"!=typeof t||Number.isNaN(t)||(n=String(t))}n&&r.set("Content-Length",n),""===e.referrerPolicy&&(e.referrerPolicy=c.Cs),e.referrer&&"no-referrer"!==e.referrer?e[h].referrer=(0,c.HH)(e):e[h].referrer="no-referrer",e[h].referrer instanceof URL&&r.set("Referer",e.referrer),r.has("User-Agent")||r.set("User-Agent","node-fetch"),e.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip, deflate, br");let{agent:a}=e;"function"==typeof a&&(a=a(t));let o=(0,u.o)(t),l={path:t.pathname+o,method:e.method,headers:r[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:e.insecureHTTPParser,agent:a};return{parsedURL:t,options:l}};n()}catch(e){n(e)}})},9464:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{Z:()=>Response});var a=r(5111),o=r(3690),i=r(7274),s=e([o]);o=(s.then?(await s)():s)[0];let l=Symbol("Response internals");let Response=class Response extends o.ZP{constructor(e=null,t={}){super(e,t);let r=null!=t.status?t.status:200,n=new a.Z(t.headers);if(null!==e&&!n.has("Content-Type")){let t=(0,o.Vl)(e,this);t&&n.append("Content-Type",t)}this[l]={type:"default",url:t.url,status:r,statusText:t.statusText||"",headers:n,counter:t.counter,highWaterMark:t.highWaterMark}}get type(){return this[l].type}get url(){return this[l].url||""}get status(){return this[l].status}get ok(){return this[l].status>=200&&this[l].status<300}get redirected(){return this[l].counter>0}get statusText(){return this[l].statusText}get headers(){return this[l].headers}get highWaterMark(){return this[l].highWaterMark}clone(){return new Response((0,o.d9)(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(e,t=302){if(!(0,i.x)(t))throw RangeError('Failed to execute "redirect" on "response": Invalid status code');return new Response(null,{headers:{location:new URL(e).toString()},status:t})}static error(){let e=new Response(null,{status:0,statusText:""});return e[l].type="error",e}static json(e,t={}){let r=JSON.stringify(e);if(void 0===r)throw TypeError("data is not JSON serializable");let n=new a.Z(t&&t.headers);return n.has("content-type")||n.set("content-type","application/json"),new Response(r,{...t,headers:n})}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(Response.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),n()}catch(e){n(e)}})},1138:(e,t,r)=>{r.d(t,{o:()=>getSearch});let getSearch=e=>{if(e.search)return e.search;let t=e.href.length-1,r=e.hash||("#"===e.href[t]?"#":"");return"?"===e.href[t-r.length]?"?":""}},7274:(e,t,r)=>{r.d(t,{x:()=>isRedirect});let n=new Set([301,302,303,307,308]),isRedirect=e=>n.has(e)},8204:(e,t,r)=>{r.d(t,{JN:()=>isDomainOrSubdomain,Lj:()=>isBlob,O0:()=>isAbortSignal,SB:()=>isURLSearchParameters,eL:()=>isSameProtocol});let n=Symbol.toStringTag,isURLSearchParameters=e=>"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&"function"==typeof e.sort&&"URLSearchParams"===e[n],isBlob=e=>e&&"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&/^(Blob|File)$/.test(e[n]),isAbortSignal=e=>"object"==typeof e&&("AbortSignal"===e[n]||"EventTarget"===e[n]),isDomainOrSubdomain=(e,t)=>{let r=new URL(t).hostname,n=new URL(e).hostname;return r===n||r.endsWith(`.${n}`)},isSameProtocol=(e,t)=>{let r=new URL(t).protocol,n=new URL(e).protocol;return r===n}},9456:(e,t,r)=>{r.d(t,{Cc:()=>parseReferrerPolicyFromHeader,Cs:()=>o,HH:()=>determineRequestsReferrer,vr:()=>validateReferrerPolicy});var n=r(7503);function stripURLForUseAsAReferrer(e,t=!1){return null==e?"no-referrer":(e=new URL(e),/^(about|blob|data):$/.test(e.protocol))?"no-referrer":(e.username="",e.password="",e.hash="",t&&(e.pathname="",e.search=""),e)}let a=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),o="strict-origin-when-cross-origin";function validateReferrerPolicy(e){if(!a.has(e))throw TypeError(`Invalid referrerPolicy: ${e}`);return e}function isUrlPotentiallyTrustworthy(e){return!!(/^about:(blank|srcdoc)$/.test(e)||"data:"===e.protocol||/^(blob|filesystem):$/.test(e.protocol))||function(e){if(/^(http|ws)s:$/.test(e.protocol))return!0;let t=e.host.replace(/(^\[)|(]$)/g,""),r=(0,n.isIP)(t);return!!(4===r&&/^127\./.test(t)||6===r&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(t))||!("localhost"===e.host||e.host.endsWith(".localhost"))&&"file:"===e.protocol}(e)}function determineRequestsReferrer(e,{referrerURLCallback:t,referrerOriginCallback:r}={}){if("no-referrer"===e.referrer||""===e.referrerPolicy)return null;let n=e.referrerPolicy;if("about:client"===e.referrer)return"no-referrer";let a=e.referrer,o=stripURLForUseAsAReferrer(a),i=stripURLForUseAsAReferrer(a,!0);o.toString().length>4096&&(o=i),t&&(o=t(o)),r&&(i=r(i));let s=new URL(e.url);switch(n){case"no-referrer":return"no-referrer";case"origin":return i;case"unsafe-url":return o;case"strict-origin":if(isUrlPotentiallyTrustworthy(o)&&!isUrlPotentiallyTrustworthy(s))return"no-referrer";return i.toString();case"strict-origin-when-cross-origin":if(o.origin===s.origin)return o;if(isUrlPotentiallyTrustworthy(o)&&!isUrlPotentiallyTrustworthy(s))return"no-referrer";return i;case"same-origin":if(o.origin===s.origin)return o;return"no-referrer";case"origin-when-cross-origin":if(o.origin===s.origin)return o;return i;case"no-referrer-when-downgrade":if(isUrlPotentiallyTrustworthy(o)&&!isUrlPotentiallyTrustworthy(s))return"no-referrer";return o;default:throw TypeError(`Invalid referrerPolicy: ${n}`)}}function parseReferrerPolicyFromHeader(e){let t=(e.get("referrer-policy")||"").split(/[,\s]+/),r="";for(let e of t)e&&a.has(e)&&(r=e);return r}}};