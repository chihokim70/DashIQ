"use strict";exports.id=63,exports.ids=[63],exports.modules={7063:(e,a,t)=>{t.a(e,async(e,r)=>{try{t.d(a,{toFormData:()=>toFormData});var n=t(1034),o=t(1691),i=e([n,o]);[n,o]=i.then?(await i)():i;let l=0,A={START_BOUNDARY:l++,HEADER_FIELD_START:l++,HEADER_FIELD:l++,HEADER_VALUE_START:l++,HEADER_VALUE:l++,HEADER_VALUE_ALMOST_DONE:l++,HEADERS_ALMOST_DONE:l++,PART_DATA_START:l++,PART_DATA:l++,END:l++},s=1,d={PART_BOUNDARY:s,LAST_BOUNDARY:s*=2},lower=e=>32|e,noop=()=>{};let MultipartParser=class MultipartParser{constructor(e){this.index=0,this.flags=0,this.onHeaderEnd=noop,this.onHeaderField=noop,this.onHeadersEnd=noop,this.onHeaderValue=noop,this.onPartBegin=noop,this.onPartData=noop,this.onPartEnd=noop,this.boundaryChars={},e="\r\n--"+e;let a=new Uint8Array(e.length);for(let t=0;t<e.length;t++)a[t]=e.charCodeAt(t),this.boundaryChars[a[t]]=!0;this.boundary=a,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=A.START_BOUNDARY}write(e){let a,t,r=0,n=e.length,o=this.index,{lookbehind:i,boundary:l,boundaryChars:s,index:E,state:D,flags:c}=this,h=this.boundary.length,T=h-1,_=e.length,mark=e=>{this[e+"Mark"]=r},clear=e=>{delete this[e+"Mark"]},callback=(e,a,t,r)=>{(void 0===a||a!==t)&&this[e](r&&r.subarray(a,t))},dataCallback=(a,t)=>{let n=a+"Mark";n in this&&(t?(callback(a,this[n],r,e),delete this[n]):(callback(a,this[n],e.length,e),this[n]=0))};for(r=0;r<n;r++)switch(a=e[r],D){case A.START_BOUNDARY:if(E===l.length-2){if(45===a)c|=d.LAST_BOUNDARY;else if(13!==a)return;E++;break}if(E-1==l.length-2){if(c&d.LAST_BOUNDARY&&45===a)D=A.END,c=0;else{if(c&d.LAST_BOUNDARY||10!==a)return;E=0,callback("onPartBegin"),D=A.HEADER_FIELD_START}break}a!==l[E+2]&&(E=-2),a===l[E+2]&&E++;break;case A.HEADER_FIELD_START:D=A.HEADER_FIELD,mark("onHeaderField"),E=0;case A.HEADER_FIELD:if(13===a){clear("onHeaderField"),D=A.HEADERS_ALMOST_DONE;break}if(E++,45===a)break;if(58===a){if(1===E)return;dataCallback("onHeaderField",!0),D=A.HEADER_VALUE_START;break}if((t=lower(a))<97||t>122)return;break;case A.HEADER_VALUE_START:if(32===a)break;mark("onHeaderValue"),D=A.HEADER_VALUE;case A.HEADER_VALUE:13===a&&(dataCallback("onHeaderValue",!0),callback("onHeaderEnd"),D=A.HEADER_VALUE_ALMOST_DONE);break;case A.HEADER_VALUE_ALMOST_DONE:if(10!==a)return;D=A.HEADER_FIELD_START;break;case A.HEADERS_ALMOST_DONE:if(10!==a)return;callback("onHeadersEnd"),D=A.PART_DATA_START;break;case A.PART_DATA_START:D=A.PART_DATA,mark("onPartData");case A.PART_DATA:if(o=E,0===E){for(r+=T;r<_&&!(e[r]in s);)r+=h;r-=T,a=e[r]}if(E<l.length)l[E]===a?(0===E&&dataCallback("onPartData",!0),E++):E=0;else if(E===l.length)E++,13===a?c|=d.PART_BOUNDARY:45===a?c|=d.LAST_BOUNDARY:E=0;else if(E-1===l.length){if(c&d.PART_BOUNDARY){if(E=0,10===a){c&=~d.PART_BOUNDARY,callback("onPartEnd"),callback("onPartBegin"),D=A.HEADER_FIELD_START;break}}else c&d.LAST_BOUNDARY&&45===a?(callback("onPartEnd"),D=A.END,c=0):E=0}if(E>0)i[E-1]=a;else if(o>0){let e=new Uint8Array(i.buffer,i.byteOffset,i.byteLength);callback("onPartData",0,o,e),o=0,mark("onPartData"),r--}break;case A.END:break;default:throw Error(`Unexpected state entered: ${D}`)}dataCallback("onHeaderField"),dataCallback("onHeaderValue"),dataCallback("onPartData"),this.index=E,this.state=D,this.flags=c}end(){if(this.state===A.HEADER_FIELD_START&&0===this.index||this.state===A.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==A.END)throw Error("MultipartParser.end(): stream ended unexpectedly")}};async function toFormData(e,a){let t,r,i,l,A,s;if(!/multipart/i.test(a))throw TypeError("Failed to fetch");let d=a.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!d)throw TypeError("no or bad content-type header, no multipart boundary");let E=new MultipartParser(d[1]||d[2]),D=[],c=new o.FormData,onPartData=e=>{i+=h.decode(e,{stream:!0})},appendToFile=e=>{D.push(e)},appendFileToFormData=()=>{let e=new n.File(D,s,{type:A});c.append(l,e)},appendEntryToFormData=()=>{c.append(l,i)},h=new TextDecoder("utf-8");for await(let a of(h.decode(),E.onPartBegin=function(){E.onPartData=onPartData,E.onPartEnd=appendEntryToFormData,t="",r="",i="",l="",A="",s=null,D.length=0},E.onHeaderField=function(e){t+=h.decode(e,{stream:!0})},E.onHeaderValue=function(e){r+=h.decode(e,{stream:!0})},E.onHeaderEnd=function(){if(r+=h.decode(),t=t.toLowerCase(),"content-disposition"===t){let e=r.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);e&&(l=e[2]||e[3]||""),(s=function(e){let a=e.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!a)return;let t=a[2]||a[3]||"",r=t.slice(t.lastIndexOf("\\")+1);return r=(r=r.replace(/%22/g,'"')).replace(/&#(\d{4});/g,(e,a)=>String.fromCharCode(a))}(r))&&(E.onPartData=appendToFile,E.onPartEnd=appendFileToFormData)}else"content-type"===t&&(A=r);r="",t=""},e))E.write(a);return E.end(),c}r()}catch(e){r(e)}})}};