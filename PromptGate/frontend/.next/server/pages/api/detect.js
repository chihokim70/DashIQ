"use strict";(()=>{var e={};e.id=434,e.ids=[434],e.modules={4379:e=>{e.exports=require("@pinecone-database/pinecone")},4001:e=>{e.exports=require("@supabase/auth-helpers-nextjs")},2885:e=>{e.exports=require("@supabase/supabase-js")},1030:e=>{e.exports=require("abort-controller")},9834:e=>{e.exports=require("agentkeepalive")},1615:e=>{e.exports=require("camelcase")},9351:e=>{e.exports=require("chromadb")},3582:e=>{e.exports=require("cors")},7904:e=>{e.exports=require("decamelize")},5755:e=>{e.exports=require("flat")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3118:e=>{e.exports=require("openai")},6998:e=>{e.exports=require("p-queue")},1917:e=>{e.exports=require("p-retry")},7747:e=>{e.exports=require("string-similarity")},3143:e=>{e.exports=require("whatwg-url")},1168:e=>{e.exports=import("data-uri-to-buffer")},4091:e=>{e.exports=import("fetch-blob")},1034:e=>{e.exports=import("fetch-blob/from.js")},5735:e=>{e.exports=import("form-data-encoder")},2962:e=>{e.exports=import("formdata-node")},7083:e=>{e.exports=import("formdata-node/file-from-path")},1691:e=>{e.exports=import("formdata-polyfill/esm.min.js")},1667:e=>{e.exports=import("langsmith")},6555:e=>{e.exports=import("uuid")},6113:e=>{e.exports=require("crypto")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},2254:e=>{e.exports=require("node:buffer")},7561:e=>{e.exports=require("node:fs")},8849:e=>{e.exports=require("node:http")},2286:e=>{e.exports=require("node:https")},7503:e=>{e.exports=require("node:net")},4492:e=>{e.exports=require("node:stream")},1041:e=>{e.exports=require("node:url")},7261:e=>{e.exports=require("node:util")},5628:e=>{e.exports=require("node:zlib")},2781:e=>{e.exports=require("stream")},7310:e=>{e.exports=require("url")},9796:e=>{e.exports=require("zlib")},9897:(e,r,t)=>{t.a(e,async(e,o)=>{try{t.r(r),t.d(r,{config:()=>l,default:()=>n,routeModule:()=>d});var s=t(1802),a=t(7153),i=t(6249),u=t(9677),p=e([u]);u=(p.then?(await p)():p)[0];let n=(0,i.l)(u,"default"),l=(0,i.l)(u,"config"),d=new s.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/detect",pathname:"/api/detect",bundlePath:"",filename:""},userland:u});o()}catch(e){o(e)}})},9677:(e,r,t)=>{t.a(e,async(e,o)=>{try{t.r(r),t.d(r,{default:()=>handler});var s=t(3582),a=t.n(s),i=t(3430),u=t(9627),p=t(9401),n=e([i]);i=(n.then?(await n)():n)[0];let l=a()({methods:["POST"]});async function handler(e,r){if(await (0,u.UE)(e,r,l),"POST"!==e.method)return r.status(405).json({error:"not_allowed",message:"Method not allowed"});try{let t=e.headers.authorization?.split(" ")[1];if(!t)return r.status(401).json({error:"unauthorized",message:"Missing API key"});let{success:o,message:s}=await (0,u.Ec)(t);if(!o)return r.status(401).json({error:"unauthorized",message:s});let{userInputBase64:a,runHeuristicCheck:n=!0,runVectorCheck:l=!0,runLanguageModelCheck:d=!0,maxHeuristicScore:x=null,maxModelScore:c=null,maxVectorScore:m=null}=e.body;try{let e=new i.J({apiKey:(0,p.lS)("REBUFF_API_KEY"),apiUrl:(0,p.lS)("REBUFF_API")??"https://api.rebuff.dev"}),t=await e.detectInjection({userInput:"",userInputBase64:a,runHeuristicCheck:n,runVectorCheck:l,runLanguageModelCheck:d,maxHeuristicScore:x,maxModelScore:c,maxVectorScore:m});return r.status(200).json(t)}catch(e){return console.error("Error in detecting injection:"),console.error(e),r.status(400).json({error:"bad_request",message:e.message})}}catch(e){return console.error("Error in detect API:"),console.error(e),r.status(500).json({error:"server_error",message:"Internal server error"})}}o()}catch(e){o(e)}})}};var r=require("../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[222,430,492,627],()=>__webpack_exec__(9897));module.exports=t})();