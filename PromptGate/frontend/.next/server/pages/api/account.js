"use strict";(()=>{var e={};e.id=100,e.ids=[100],e.modules={4001:e=>{e.exports=require("@supabase/auth-helpers-nextjs")},2885:e=>{e.exports=require("@supabase/supabase-js")},3582:e=>{e.exports=require("cors")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},9295:(e,t,r)=>{r.r(t),r.d(t,{config:()=>h,default:()=>g,routeModule:()=>f});var s={};r.r(s),r.d(s,{default:()=>handler});var a=r(1802),u=r(7153),o=r(6249),i=r(3582),n=r.n(i),l=r(4001),d=r(2201),c=r(4120);let p=n()({methods:["POST","GET","HEAD"]});async function handler(e,t){if(await new Promise((r,s)=>{p(e,t,e=>e instanceof Error?s(e):r(e))}),!["POST","GET"].includes(e.method||""))return t.status(405).json({error:"not_allowed",message:"Method not allowed"});let r=(0,l.createServerSupabaseClient)({req:e,res:t}),{data:{session:s}}=await r.auth.getSession();if(!s)return t.status(401).json({error:"not_authenticated",message:"not authenticated"});let{data:{user:a}}=await r.auth.getUser();if(!a)return t.status(401).json({error:"not_authenticated",message:"not authenticated"});try{switch(e.method){case"GET":if(!e.query.slug){let e=await Promise.allSettled([(0,c.Gg)(a),(0,c.X_)(a)]),r={apikey:"",credits:0,stats:{breaches:{total:0,user:0},detections:0,requests:0}};return"fulfilled"===e[0].status?(r.apikey=e[0].value.apikey,r.credits=e[0].value.credits):console.error(`Error getting apikey + credits for user: ${a.id}`),"fulfilled"===e[1].status?r.stats=e[1].value:console.error(`Error getting stats for user: ${a.id}`),t.status(200).json(r)}case"POST":if(Array.isArray(e.query.slug)&&1===e.query.slug.length&&"apikey"===e.query.slug[0]){let e=(0,d.Z)();return await (0,c.PT)(a,e),t.status(200).json({apikey:e})}}}catch(e){return console.error(e),t.status(500).json({error:"server_error",message:"something went wrong"})}return t.status(404)}let g=(0,o.l)(s,"default"),h=(0,o.l)(s,"config"),f=new a.PagesAPIRouteModule({definition:{kind:u.x.PAGES_API,page:"/api/account",pathname:"/api/account",bundlePath:"",filename:""},userland:s})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[222,492,120],()=>__webpack_exec__(9295));module.exports=r})();