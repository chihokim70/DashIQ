"use strict";(()=>{var e={};e.id=183,e.ids=[183],e.modules={4379:e=>{e.exports=require("@pinecone-database/pinecone")},4001:e=>{e.exports=require("@supabase/auth-helpers-nextjs")},2885:e=>{e.exports=require("@supabase/supabase-js")},3582:e=>{e.exports=require("cors")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3118:e=>{e.exports=require("openai")},7747:e=>{e.exports=require("string-similarity")},7795:(e,r,s)=>{s.r(r),s.d(r,{config:()=>_,default:()=>p,routeModule:()=>g});var o={};s.r(o),s.d(o,{default:()=>handler});var t=s(1802),a=s(7153),n=s(6249),i=s(3582),u=s.n(i),l=s(9627),d=s(9492);let c=u()({methods:["POST"]});async function handler(e,r){if(await (0,l.UE)(e,r,c),"POST"!==e.method)return r.status(405).json({error:"not_allowed",message:"Method not allowed"});try{let s=e.headers.authorization?.split(" ")[1];if(!s)return r.status(401).json({error:"unauthorized",message:"Missing API key"});let{success:o,message:t,account_id:a}=await (0,l.r4)(s);if(!o)return r.status(401).json({error:"unauthorized",message:t});if(null==a)return console.log("ignoring log leak request, no account_id found"),r.status(200).json({success:!0});let{user_input:n,completion:i,canaryWord:u}=e.body,{error:c}=await d.oY.from("leak_logs").insert([{account_id:a,user_input:n,completion:i,canary_word:u}]);if(c)return console.error(c),r.status(500).json({error:"server_error",message:"Internal server error"});return r.status(200).json({success:!0})}catch(e){return console.error("Error in log API:"),console.error(e),console.trace(),r.status(500).json({error:"server_error",message:"Internal server error"})}}let p=(0,n.l)(o,"default"),_=(0,n.l)(o,"config"),g=new t.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/log",pathname:"/api/log",bundlePath:"",filename:""},userland:o})}};var r=require("../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),s=r.X(0,[222,492,627],()=>__webpack_exec__(7795));module.exports=s})();