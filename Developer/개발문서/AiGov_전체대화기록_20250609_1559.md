# KRA-AIGov 전체 대화 로그 (2025년 6월 9일)

---

## ✅ 시스템/환경 설정

- Ubuntu 22.04 + Docker 환경에서 개발 시작
- PromptGate, DashAILog, ShadowScan, TrustLLM 등 하위 프로젝트 폴더 구성
- Python 가상환경 기반 개발환경 구성 (`venv`)
- Docker Compose로 Elasticsearch 보안 서버 별도 구성 (`secure-es`)

---

## ✅ Rebuff 기반 프록시 구현 (PromptGate)

### 🔹 구조 확정
- Rebuff 오픈소스는 server 기반 대신 python-sdk 기준으로 사용
- FastAPI 프로젝트 구조에 맞춰 app/core/filter.py 생성
- Prompt 검사를 위한 `PromptFilter` 클래스 구현

### 🔹 프록시 라우터 구현
- `/proxy` POST API에서 prompt 필터링 및 결과 반환
- 차단된 경우 score, 이유 포함 응답

---

## ✅ 로그 기록 시스템

- `loguru` 콘솔 로그 구현
- `log_to_elasticsearch()` 함수로 Elasticsearch 연동
- .env 파일 기반으로 URL, 인증정보 구성

---

## ✅ 민감 정보 마스킹

- email, 주민번호, 카드번호, 비밀번호 등 정규표현식으로 필터링
- app/core/security.py 모듈로 구성

---

## ✅ Elasticsearch 보안 설정

- Docker Compose로 인증 활성화된 Elasticsearch 실행
- ID/PW (http_auth) 방식 접속 테스트 완료
- TLS 보안 통신은 후속 작업으로 계획
- log_to_elasticsearch에서 인증 포함 연결 설정

---

## ✅ 관리자 콘솔 요구 사항 논의

- 프롬프트 로그는 UI 관리 콘솔(DashAILog)에서 조회 가능해야 함
- `/logs` API, 사용자별 필터링, 차단된 항목 요약 등 기능 계획
- React 또는 Next.js 기반 대시보드 UI 구상

---

## ✅ 주요 구현 대상 요약

| 기능 | 설명 |
|------|------|
| Prompt 필터링 | Rebuff SDK 사용, FastAPI `/proxy` 라우터 |
| 민감정보 마스킹 | 정규표현식 필터 적용 |
| 로그 기록 | Elasticsearch 연동 + 콘솔 출력 |
| 보안 연동 | 인증 기반 ES 접속, TLS 후속 예정 |
| 관리자 UI | 로그 조회, 차단 로그 분석, 통계 시각화 예정 |

---

